<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hanimus LLC - IT Tech Dispatch</title>
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="Professional IT technician dispatch and service request management for Sacramento area businesses. 24/7 certified IT support from Hanimus LLC.">
    <meta name="keywords" content="IT support, technician dispatch, IT services, Sacramento IT, Citrus Heights, technical support">
    <meta name="author" content="Hanimus LLC">
    
    <!-- Open Graph / Social Media -->
    <meta property="og:title" content="Hanimus LLC - IT Tech Dispatch">
    <meta property="og:description" content="Streamline your IT operations with intelligent technician dispatch and service request management">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://hanimus.com">
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' rx='10' fill='%23DC2626'/><text x='50' y='65' font-size='50' fill='white' text-anchor='middle' font-family='Arial'>H</text></svg>">
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #0f172a; }
        .gradient-bg { background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%); }
        .card-hover { transition: all 0.3s ease; }
        .card-hover:hover { transform: translateY(-4px); box-shadow: 0 20px 25px -5px rgba(185, 28, 28, 0.4); }
        .logo-container { background: white; padding: 1.5rem; border-radius: 1rem; display: inline-block; }
        [dir="rtl"] { text-align: right; }
    </style>
</head>
<body class="bg-slate-950 text-slate-100">
    <div id="root"></div>

    <script type="text/babel">
        // ============================================
        // FIREBASE CONFIGURATION
        // ============================================
        const firebaseConfig = {
            apiKey: "AIzaSyAnCHNfoslDSbrvqlQsLFcicjmo4G0ECVc",
            authDomain: "hanimus-dispatch.firebaseapp.com",
            databaseURL: "https://hanimus-dispatch-default-rtdb.firebaseio.com",
            projectId: "hanimus-dispatch",
            storageBucket: "hanimus-dispatch.firebasestorage.app",
            messagingSenderId: "779431998540",
            appId: "1:779431998540:web:1948b2777c77a5880930e9",
            measurementId: "G-K17S14ZD1P"
        };

        // Initialize Firebase
        if (!firebase.apps.length) {
            firebase.initializeApp(firebaseConfig);
        }
        const database = firebase.database();
        const auth = firebase.auth();

        // ============================================
        // DATABASE HELPER FUNCTIONS
        // ============================================
        const DB = {
            // Customers
            async getCustomers() {
                const snapshot = await database.ref('customers').once('value');
                return snapshot.val() || {};
            },
            async getCustomer(id) {
                const snapshot = await database.ref(`customers/${id}`).once('value');
                return snapshot.val();
            },
            async saveCustomer(id, data) {
                await database.ref(`customers/${id}`).set(data);
            },
            async deleteCustomer(id) {
                await database.ref(`customers/${id}`).remove();
            },
            
            // Technicians
            async getTechnicians() {
                const snapshot = await database.ref('technicians').once('value');
                return snapshot.val() || {};
            },
            async getTechnician(id) {
                const snapshot = await database.ref(`technicians/${id}`).once('value');
                return snapshot.val();
            },
            async saveTechnician(id, data) {
                await database.ref(`technicians/${id}`).set(data);
            },
            async deleteTechnician(id) {
                await database.ref(`technicians/${id}`).remove();
            },
            
            // Service Requests
            async getRequests() {
                const snapshot = await database.ref('requests').once('value');
                return snapshot.val() || {};
            },
            async getRequest(id) {
                const snapshot = await database.ref(`requests/${id}`).once('value');
                return snapshot.val();
            },
            async saveRequest(id, data) {
                await database.ref(`requests/${id}`).set(data);
            },
            async deleteRequest(id) {
                await database.ref(`requests/${id}`).remove();
            },
            
            // Admin
            async getAdmins() {
                const snapshot = await database.ref('admins').once('value');
                return snapshot.val() || {};
            },
            async saveAdmin(id, data) {
                await database.ref(`admins/${id}`).set(data);
            },
            
            // Real-time listeners
            onCustomersChange(callback) {
                return database.ref('customers').on('value', snapshot => {
                    callback(snapshot.val() || {});
                });
            },
            onTechniciansChange(callback) {
                return database.ref('technicians').on('value', snapshot => {
                    callback(snapshot.val() || {});
                });
            },
            onRequestsChange(callback) {
                return database.ref('requests').on('value', snapshot => {
                    callback(snapshot.val() || {});
                });
            },
            
            // Unsubscribe from listeners
            offCustomersChange() {
                database.ref('customers').off('value');
            },
            offTechniciansChange() {
                database.ref('technicians').off('value');
            },
            offRequestsChange() {
                database.ref('requests').off('value');
            }
        };

        const { useState, useEffect } = React;

        const logoPath = './fulllogo.png';
        const logoExists = false;

        // Translations (keeping the same structure as original)
        const translations = {
            en: {
                heroTitle: "IT Tech Dispatch",
                heroSubtitle: "Streamline your IT operations with intelligent technician dispatch and service request management",
                registerCustomer: "Register as Customer",
                applyTechnician: "Apply as Technician",
                signIn: "Sign In",
                whatWeDo: "What We Do",
                missionText: "At Hanimus LLC, we don't just manage IT requests‚Äîwe revolutionize them. Headquartered in Citrus Heights and serving the greater Sacramento area, our mission is clear: to connect businesses with certified IT professionals through a seamless, intelligent dispatch platform that eliminates downtime and maximizes efficiency.",
                smartDispatch: "Smart Dispatch System",
                smartDispatchDesc: "Our intelligent platform matches your IT needs with the right certified technician‚Äîinstantly. From network issues to hardware failures, from security concerns to software troubleshooting, we ensure the perfect match every time.",
                certifiedPros: "Certified Professionals",
                certifiedProsDesc: "We don't just hire technicians‚Äîwe cultivate excellence. Every professional on our platform undergoes rigorous vetting, bringing certifications, real-world experience, and a commitment to solving your IT challenges with precision.",
                availability247: "24/7 Availability",
                availability247Desc: "Technology issues don't wait for business hours‚Äîneither do we. Our platform operates around the clock, ensuring you can submit requests, track progress, and connect with technicians whenever urgent needs arise.",
                whoWeServe: "Who We Serve",
                whoWeServeDesc: "From small businesses to enterprise organizations, from healthcare facilities to educational institutions, from retail operations to professional services‚Äîwe provide tailored IT support solutions that scale with your needs.",
                healthcare: "Healthcare",
                corporate: "Corporate",
                education: "Education",
                retail: "Retail",
                whyChoose: "Why Choose Hanimus LLC?",
                realTimeTracking: "Real-Time Tracking",
                realTimeTrackingDesc: "Monitor every step of your service request from submission to completion with full transparency.",
                qualityAssurance: "Quality Assurance",
                qualityAssuranceDesc: "Every job requires technician completion notes and customer review, ensuring accountability and excellence.",
                rapidResponse: "Rapid Response",
                rapidResponseDesc: "Our priority-based system ensures urgent issues get immediate attention from available technicians.",
                completeDoc: "Complete Documentation",
                completeDocDesc: "Full audit trails, technician notes, and customer feedback for every service request.",
                copyright: "¬© 2002-2024 Hanimus LLC. All rights reserved.",
                loginTitle: "Sign in to your account",
                email: "Email",
                password: "Password",
                confirmPassword: "Confirm Password",
                login: "Sign In",
                registerAsCustomer: "Register as Customer ‚Üí",
                applyAsTechnician: "Apply as Technician ‚Üí",
                back: "‚Üê Back",
                demoAccounts: "Ensure the email contains all required information:",
                logout: "Logout",
                cancel: "Cancel",
                submit: "Submit",
                name: "Name",
                phone: "Phone",
                address: "Address",
                requests: "Requests",
                technicians: "Technicians",
                customers: "Customers",
                myRequests: "My Requests",
                newRequest: "New Request",
                myJobs: "My Jobs",
                total: "Total",
                pending: "Pending",
                active: "Active",
                inProgress: "In Progress",
                completed: "Completed",
                review: "Review",
                readyToReview: "Ready to Review",
                awaitingReview: "Awaiting Review",
            },
            ar: {
                heroTitle: "ŸÜÿ∏ÿßŸÖ ÿ•ÿ±ÿ≥ÿßŸÑ ÿ™ŸÇŸÜŸäÿ© ÿßŸÑŸÖÿπŸÑŸàŸÖÿßÿ™",
                heroSubtitle: "ŸÇŸÖ ÿ®ÿ™ÿ®ÿ≥Ÿäÿ∑ ÿπŸÖŸÑŸäÿßÿ™ ÿ™ŸÇŸÜŸäÿ© ÿßŸÑŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑÿÆÿßÿµÿ© ÿ®ŸÉ ŸÖŸÜ ÿÆŸÑÿßŸÑ ŸÜÿ∏ÿßŸÖ ÿ∞ŸÉŸä ŸÑÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑŸÅŸÜŸäŸäŸÜ Ÿàÿ•ÿØÿßÿ±ÿ© ÿ∑ŸÑÿ®ÿßÿ™ ÿßŸÑÿÆÿØŸÖÿ©",
                registerCustomer: "ÿßŸÑÿ™ÿ≥ÿ¨ŸäŸÑ ŸÉÿπŸÖŸäŸÑ",
                applyTechnician: "ÿßŸÑÿ™ŸÇÿØŸäŸÖ ŸÉŸÅŸÜŸä",
                signIn: "ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ",
                whatWeDo: "ŸÖÿß ŸÜŸÇŸàŸÖ ÿ®Ÿá",
                missionText: "ŸÅŸä ÿ¥ÿ±ŸÉÿ© Hanimus LLCÿå ŸÜÿ≠ŸÜ ŸÑÿß ŸÜÿØŸäÿ± ÿ∑ŸÑÿ®ÿßÿ™ ÿ™ŸÇŸÜŸäÿ© ÿßŸÑŸÖÿπŸÑŸàŸÖÿßÿ™ ŸÅÿ≠ÿ≥ÿ® - ÿ®ŸÑ ŸÜÿ≠ÿØÿ´ ÿ´Ÿàÿ±ÿ© ŸÅŸäŸáÿß.",
                smartDispatch: "ŸÜÿ∏ÿßŸÖ ÿßŸÑÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑÿ∞ŸÉŸä",
                smartDispatchDesc: "ÿ™ŸÇŸàŸÖ ŸÖŸÜÿµÿ™ŸÜÿß ÿßŸÑÿ∞ŸÉŸäÿ© ÿ®ŸÖÿ∑ÿßÿ®ŸÇÿ© ÿßÿ≠ÿ™Ÿäÿßÿ¨ÿßÿ™ŸÉ ŸÅŸä ÿ™ŸÇŸÜŸäÿ© ÿßŸÑŸÖÿπŸÑŸàŸÖÿßÿ™ ŸÖÿπ ÿßŸÑŸÅŸÜŸä ÿßŸÑŸÖÿπÿ™ŸÖÿØ ÿßŸÑŸÖŸÜÿßÿ≥ÿ®.",
                certifiedPros: "ŸÖÿ≠ÿ™ÿ±ŸÅŸàŸÜ ŸÖÿπÿ™ŸÖÿØŸàŸÜ",
                certifiedProsDesc: "ŸÜÿ≠ŸÜ ŸÑÿß ŸÜŸàÿ∏ŸÅ ŸÅŸÜŸäŸäŸÜ ŸÅŸÇÿ∑ - ÿ®ŸÑ ŸÜÿ≤ÿ±ÿπ ÿßŸÑÿ™ŸÖŸäÿ≤.",
                availability247: "ÿ™ŸàŸÅÿ± ÿπŸÑŸâ ŸÖÿØÿßÿ± ÿßŸÑÿ≥ÿßÿπÿ© ÿ∑ŸàÿßŸÑ ÿ£ŸäÿßŸÖ ÿßŸÑÿ£ÿ≥ÿ®Ÿàÿπ",
                availability247Desc: "ŸÖÿ¥ÿßŸÉŸÑ ÿßŸÑÿ™ŸÉŸÜŸàŸÑŸàÿ¨Ÿäÿß ŸÑÿß ÿ™ŸÜÿ™ÿ∏ÿ± ÿ≥ÿßÿπÿßÿ™ ÿßŸÑÿπŸÖŸÑ - ŸÜÿ≠ŸÜ ŸÉÿ∞ŸÑŸÉ.",
                whoWeServe: "ŸÖŸÜ ŸÜÿÆÿØŸÖ",
                whoWeServeDesc: "ŸÖŸÜ ÿßŸÑÿ¥ÿ±ŸÉÿßÿ™ ÿßŸÑÿµÿ∫Ÿäÿ±ÿ© ÿ•ŸÑŸâ ÿßŸÑŸÖÿ§ÿ≥ÿ≥ÿßÿ™ ÿßŸÑŸÉÿ®Ÿäÿ±ÿ©ÿå ŸÜŸÇÿØŸÖ ÿ≠ŸÑŸàŸÑ ÿØÿπŸÖ ÿ™ŸÇŸÜŸäÿ© ÿßŸÑŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑŸÖÿÆÿµÿµÿ©.",
                healthcare: "ÿßŸÑÿ±ÿπÿßŸäÿ© ÿßŸÑÿµÿ≠Ÿäÿ©",
                corporate: "ÿßŸÑÿ¥ÿ±ŸÉÿßÿ™",
                education: "ÿßŸÑÿ™ÿπŸÑŸäŸÖ",
                retail: "ÿßŸÑÿ™ÿ¨ÿ≤ÿ¶ÿ©",
                whyChoose: "ŸÑŸÖÿßÿ∞ÿß ÿ™ÿÆÿ™ÿßÿ± Hanimus LLCÿü",
                realTimeTracking: "ÿßŸÑÿ™ÿ™ÿ®ÿπ ŸÅŸä ÿßŸÑŸàŸÇÿ™ ÿßŸÑŸÅÿπŸÑŸä",
                realTimeTrackingDesc: "ÿ±ÿßŸÇÿ® ŸÉŸÑ ÿÆÿ∑Ÿàÿ© ŸÖŸÜ ÿ∑ŸÑÿ® ÿßŸÑÿÆÿØŸÖÿ© ÿßŸÑÿÆÿßÿµ ÿ®ŸÉ.",
                qualityAssurance: "ÿ∂ŸÖÿßŸÜ ÿßŸÑÿ¨ŸàÿØÿ©",
                qualityAssuranceDesc: "ŸÉŸÑ Ÿàÿ∏ŸäŸÅÿ© ÿ™ÿ™ÿ∑ŸÑÿ® ŸÖŸÑÿßÿ≠ÿ∏ÿßÿ™ ÿ•ŸÉŸÖÿßŸÑ ÿßŸÑŸÅŸÜŸä ŸàŸÖÿ±ÿßÿ¨ÿπÿ© ÿßŸÑÿπŸÖŸäŸÑ.",
                rapidResponse: "ÿßÿ≥ÿ™ÿ¨ÿßÿ®ÿ© ÿ≥ÿ±Ÿäÿπÿ©",
                rapidResponseDesc: "ŸÜÿ∏ÿßŸÖŸÜÿß ÿßŸÑŸÇÿßÿ¶ŸÖ ÿπŸÑŸâ ÿßŸÑÿ£ŸàŸÑŸàŸäÿ© Ÿäÿ∂ŸÖŸÜ ÿßŸáÿ™ŸÖÿßŸÖÿß ŸÅŸàÿ±Ÿäÿß ÿ®ÿßŸÑŸÖÿ¥ŸÉŸÑÿßÿ™ ÿßŸÑÿπÿßÿ¨ŸÑÿ©.",
                completeDoc: "ÿ™Ÿàÿ´ŸäŸÇ ŸÉÿßŸÖŸÑ",
                completeDocDesc: "ÿ≥ÿ¨ŸÑÿßÿ™ ÿ™ÿØŸÇŸäŸÇ ŸÉÿßŸÖŸÑÿ© ŸàŸÖŸÑÿßÿ≠ÿ∏ÿßÿ™ ÿßŸÑŸÅŸÜŸä Ÿàÿ™ÿπŸÑŸäŸÇÿßÿ™ ÿßŸÑÿπŸÖŸÑÿßÿ°.",
                copyright: "¬© 2002-2024 Hanimus LLC. ÿ¨ŸÖŸäÿπ ÿßŸÑÿ≠ŸÇŸàŸÇ ŸÖÿ≠ŸÅŸàÿ∏ÿ©.",
                loginTitle: "ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ ÿ•ŸÑŸâ ÿ≠ÿ≥ÿßÿ®ŸÉ",
                email: "ÿßŸÑÿ®ÿ±ŸäÿØ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä",
                password: "ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ±",
                confirmPassword: "ÿ™ÿ£ŸÉŸäÿØ ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ±",
                login: "ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ",
                registerAsCustomer: "‚Üê ÿßŸÑÿ™ÿ≥ÿ¨ŸäŸÑ ŸÉÿπŸÖŸäŸÑ",
                applyAsTechnician: "‚Üê ÿßŸÑÿ™ŸÇÿØŸäŸÖ ŸÉŸÅŸÜŸä",
                back: "ÿßŸÑÿπŸàÿØÿ© ‚Üê",
                demoAccounts: "ÿ≠ÿ≥ÿßÿ®ÿßÿ™ ÿ™ÿ¨ÿ±Ÿäÿ®Ÿäÿ©:",
                logout: "ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿÆÿ±Ÿàÿ¨",
                cancel: "ÿ•ŸÑÿ∫ÿßÿ°",
                submit: "ÿ•ÿ±ÿ≥ÿßŸÑ",
                name: "ÿßŸÑÿßÿ≥ŸÖ",
                phone: "ÿßŸÑŸáÿßÿ™ŸÅ",
                address: "ÿßŸÑÿπŸÜŸàÿßŸÜ",
                requests: "ÿßŸÑÿ∑ŸÑÿ®ÿßÿ™",
                technicians: "ÿßŸÑŸÅŸÜŸäŸàŸÜ",
                customers: "ÿßŸÑÿπŸÖŸÑÿßÿ°",
                myRequests: "ÿ∑ŸÑÿ®ÿßÿ™Ÿä",
                newRequest: "ÿ∑ŸÑÿ® ÿ¨ÿØŸäÿØ",
                myJobs: "Ÿàÿ∏ÿßÿ¶ŸÅŸä",
                total: "ÿßŸÑŸÖÿ¨ŸÖŸàÿπ",
                pending: "ŸÇŸäÿØ ÿßŸÑÿßŸÜÿ™ÿ∏ÿßÿ±",
                active: "ŸÜÿ¥ÿ∑",
                inProgress: "ŸÇŸäÿØ ÿßŸÑÿ™ŸÜŸÅŸäÿ∞",
                completed: "ŸÖŸÉÿ™ŸÖŸÑ",
                review: "ŸÖÿ±ÿßÿ¨ÿπÿ©",
                readyToReview: "ÿ¨ÿßŸáÿ≤ ŸÑŸÑŸÖÿ±ÿßÿ¨ÿπÿ©",
                awaitingReview: "ŸÅŸä ÿßŸÜÿ™ÿ∏ÿßÿ± ÿßŸÑŸÖÿ±ÿßÿ¨ÿπÿ©",
            }
        };

        const App = () => {
            const [currentView, setCurrentView] = useState('landing');
            const [currentUser, setCurrentUser] = useState(null);
            const [language, setLanguage] = useState('en');
            const [loading, setLoading] = useState(true);
            
            // Real-time data states
            const [customers, setCustomers] = useState({});
            const [technicians, setTechnicians] = useState({});
            const [requests, setRequests] = useState({});

            const t = (key) => translations[language][key] || key;

            // Initialize app and load data
            useEffect(() => {
                const initApp = async () => {
                    try {
                        console.log('üî• Starting Firebase initialization...');
                        console.log('üì° Database URL:', firebaseConfig.databaseURL);
                        
                        // Test Firebase connection
                        console.log('üîç Testing Firebase connection...');
                        await database.ref('.info/connected').once('value');
                        console.log('‚úÖ Firebase connected successfully!');
                        
                        // Load initial data
                        console.log('üì• Loading data from Firebase...');
                        const [customersData, techniciansData, requestsData] = await Promise.all([
                            DB.getCustomers(),
                            DB.getTechnicians(),
                            DB.getRequests()
                        ]);
                        
                        console.log('‚úÖ Customers loaded:', Object.keys(customersData).length);
                        console.log('‚úÖ Technicians loaded:', Object.keys(techniciansData).length);
                        console.log('‚úÖ Requests loaded:', Object.keys(requestsData).length);
                        
                        setCustomers(customersData);
                        setTechnicians(techniciansData);
                        setRequests(requestsData);

                        // Set up real-time listeners
                        console.log('üëÇ Setting up real-time listeners...');
                        DB.onCustomersChange(setCustomers);
                        DB.onTechniciansChange(setTechnicians);
                        DB.onRequestsChange(setRequests);
                        console.log('‚úÖ Listeners active!');

                        // Check for saved session (using localStorage for session only)
                        const savedUser = localStorage.getItem('currentUser');
                        if (savedUser) {
                            console.log('üë§ Found saved session');
                            const user = JSON.parse(savedUser);
                            setCurrentUser(user);
                            
                            if (user.role === 'customer') setCurrentView('customer-dashboard');
                            else if (user.role === 'technician') setCurrentView('technician-dashboard');
                            else if (user.role === 'admin') setCurrentView('admin-dashboard');
                        } else {
                            console.log('üë§ No saved session found');
                        }
                        
                        console.log('üéâ Initialization complete!');
                    } catch (error) {
                        console.error('‚ùå ERROR during initialization:', error);
                        console.error('Error details:', {
                            message: error.message,
                            code: error.code,
                            stack: error.stack
                        });
                        
                        // Show user-friendly error
                        let errorMessage = 'Error connecting to database.\n\n';
                        
                        if (error.code === 'PERMISSION_DENIED') {
                            errorMessage += 'üîí PERMISSION DENIED\n\nYour database rules are blocking access.\n\n';
                            errorMessage += 'FIX: Go to Firebase Console ‚Üí Database ‚Üí Rules\n';
                            errorMessage += 'Set to: { "rules": { ".read": true, ".write": true } }';
                        } else if (error.message.includes('network')) {
                            errorMessage += 'üåê NETWORK ERROR\n\nCannot connect to Firebase.\n\n';
                            errorMessage += 'Check your internet connection.';
                        } else if (error.message.includes('not found')) {
                            errorMessage += 'üì¶ DATABASE NOT FOUND\n\nYou need to create the Realtime Database.\n\n';
                            errorMessage += 'FIX: Firebase Console ‚Üí Create Database ‚Üí Test Mode';
                        } else {
                            errorMessage += 'Details: ' + error.message + '\n\n';
                            errorMessage += 'Check the browser console (F12) for more information.';
                        }
                        
                        alert(errorMessage);
                    } finally {
                        console.log('‚è±Ô∏è Setting loading to false');
                        setLoading(false);
                    }
                };

                initApp();

                // Cleanup listeners on unmount
                return () => {
                    console.log('üßπ Cleaning up listeners...');
                    DB.offCustomersChange();
                    DB.offTechniciansChange();
                    DB.offRequestsChange();
                };
            }, []);

            const handleLogin = async (email, password) => {
                try {
                    // Check admin
                    const admins = await DB.getAdmins();
                    const admin = Object.entries(admins).find(([id, a]) => 
                        a.email === email && a.password === password
                    );
                    if (admin) {
                        const user = { ...admin[1], id: admin[0], role: 'admin' };
                        setCurrentUser(user);
                        localStorage.setItem('currentUser', JSON.stringify(user));
                        setCurrentView('admin-dashboard');
                        return true;
                    }

                    // Check customers
                    const customer = Object.entries(customers).find(([id, c]) => 
                        c.email === email && c.password === password
                    );
                    if (customer) {
                        const user = { ...customer[1], id: customer[0], role: 'customer' };
                        setCurrentUser(user);
                        localStorage.setItem('currentUser', JSON.stringify(user));
                        setCurrentView('customer-dashboard');
                        return true;
                    }

                    // Check technicians
                    const tech = Object.entries(technicians).find(([id, t]) => 
                        t.email === email && t.password === password
                    );
                    if (tech) {
                        const user = { ...tech[1], id: tech[0], role: 'technician' };
                        setCurrentUser(user);
                        localStorage.setItem('currentUser', JSON.stringify(user));
                        setCurrentView('technician-dashboard');
                        return true;
                    }

                    alert('Invalid credentials');
                    return false;
                } catch (error) {
                    console.error('Login error:', error);
                    alert('Error during login');
                    return false;
                }
            };

            const handleRegisterCustomer = async (data) => {
                try {
                    // Check if email already exists
                    const existingCustomer = Object.values(customers).find(c => c.email === data.email);
                    if (existingCustomer) {
                        alert('Email already registered');
                        return false;
                    }

                    const id = 'cust_' + Date.now();
                    const customerData = {
                        ...data,
                        createdAt: new Date().toISOString()
                    };
                    
                    await DB.saveCustomer(id, customerData);
                    alert('Registration successful! Please login.');
                    setCurrentView('login');
                    return true;
                } catch (error) {
                    console.error('Registration error:', error);
                    alert('Error during registration');
                    return false;
                }
            };

            const handleRegisterTechnician = async (data) => {
                try {
                    const existingTech = Object.values(technicians).find(t => t.email === data.email);
                    if (existingTech) {
                        alert('Email already registered');
                        return false;
                    }

                    const id = 'tech_' + Date.now();
                    const techData = {
                        ...data,
                        status: 'pending',
                        createdAt: new Date().toISOString()
                    };
                    
                    await DB.saveTechnician(id, techData);
                    alert('Application submitted! Admin will review your application.');
                    setCurrentView('login');
                    return true;
                } catch (error) {
                    console.error('Technician registration error:', error);
                    alert('Error submitting application');
                    return false;
                }
            };

            const handleLogout = () => {
                setCurrentUser(null);
                localStorage.removeItem('currentUser');
                setCurrentView('landing');
            };

            const handleSubmitRequest = async (requestData) => {
                try {
                    const id = 'req_' + Date.now();
                    const request = {
                        ...requestData,
                        customerId: currentUser.id,
                        customerName: currentUser.name,
                        status: 'pending',
                        createdAt: new Date().toISOString()
                    };
                    
                    await DB.saveRequest(id, request);
                    alert('Request submitted successfully!');
                    setCurrentView('customer-dashboard');
                    return true;
                } catch (error) {
                    console.error('Error submitting request:', error);
                    alert('Error submitting request');
                    return false;
                }
            };

            if (loading) {
                return (
                    <div className="min-h-screen flex items-center justify-center bg-slate-950">
                        <div className="text-center max-w-2xl px-4">
                            <div className="text-6xl mb-6 animate-spin">‚öôÔ∏è</div>
                            <p className="text-2xl text-white mb-4">Connecting to Firebase...</p>
                            <p className="text-slate-400 mb-6">If this takes more than 5 seconds, there's a problem.</p>
                            <div className="bg-slate-800 border border-slate-700 rounded-xl p-6 text-left">
                                <p className="text-white font-bold mb-2">üîç Debugging Steps:</p>
                                <ol className="text-slate-300 space-y-2 text-sm">
                                    <li>1. Press <kbd className="bg-slate-900 px-2 py-1 rounded">F12</kbd> to open Developer Console</li>
                                    <li>2. Click the "Console" tab</li>
                                    <li>3. Look for RED error messages</li>
                                    <li>4. Check TROUBLESHOOTING.md for solutions</li>
                                </ol>
                            </div>
                            <div className="mt-6 bg-yellow-900/30 border border-yellow-600 rounded-xl p-4">
                                <p className="text-yellow-500 font-semibold mb-2">‚ö†Ô∏è Most Common Issue:</p>
                                <p className="text-yellow-300 text-sm">Database rules not set to TEST MODE</p>
                                <p className="text-yellow-400 text-xs mt-2">
                                    Fix: Firebase Console ‚Üí Database ‚Üí Rules ‚Üí Set to test mode
                                </p>
                            </div>
                        </div>
                    </div>
                );
            }

            // Logo Component
            const Logo = ({ size = 'large' }) => (
                <div className={`flex items-center gap-3 ${size === 'large' ? 'text-3xl' : 'text-xl'}`}>
                    {logoExists ? (
                        <img src={logoPath} alt="Hanimus LLC" className={size === 'large' ? 'h-16' : 'h-10'} />
                    ) : (
                        <>
                            <div className={`${size === 'large' ? 'w-14 h-14' : 'w-8 h-8'} bg-red-700 rounded-lg flex items-center justify-center font-black text-white`}>
                                H
                            </div>
                            <span className="font-black text-white">HANIMUS</span>
                        </>
                    )}
                </div>
            );

            // Stats Card Component
            const StatsCard = ({ title, value, icon, color = 'blue' }) => (
                <div className={`bg-gradient-to-br from-slate-800 to-slate-900 rounded-xl p-6 border border-slate-700 hover:border-${color}-500 transition card-hover`}>
                    <div className="flex items-center justify-between">
                        <div>
                            <p className="text-slate-400 text-sm mb-1">{title}</p>
                            <p className="text-3xl font-bold text-white">{value}</p>
                        </div>
                        <div className={`text-4xl opacity-50`}>{icon}</div>
                    </div>
                </div>
            );

            // Request Card Component
            const RequestCard = ({ request, onAction, showCustomer = false, showTechnician = false }) => {
                const statusColors = {
                    pending: 'bg-yellow-500/20 text-yellow-500 border-yellow-500/30',
                    active: 'bg-blue-500/20 text-blue-500 border-blue-500/30',
                    'in-progress': 'bg-purple-500/20 text-purple-500 border-purple-500/30',
                    completed: 'bg-green-500/20 text-green-500 border-green-500/30',
                    reviewed: 'bg-slate-500/20 text-slate-500 border-slate-500/30'
                };

                const priorityColors = {
                    low: 'text-green-400',
                    medium: 'text-yellow-400',
                    high: 'text-orange-400',
                    critical: 'text-red-400'
                };

                return (
                    <div className="bg-slate-800 border border-slate-700 rounded-xl p-6 hover:border-red-700 transition card-hover">
                        <div className="flex justify-between items-start mb-4">
                            <div>
                                <h3 className="text-xl font-bold text-white mb-2">{request.title}</h3>
                                <p className="text-slate-400">{request.description}</p>
                            </div>
                            <div className="flex gap-2 items-center">
                                <span className={`px-3 py-1 rounded-full text-xs font-semibold border ${statusColors[request.status]}`}>
                                    {request.status}
                                </span>
                                <span className={`text-2xl ${priorityColors[request.priority]}`}>
                                    {request.priority === 'critical' ? 'üî¥' : request.priority === 'high' ? 'üü†' : request.priority === 'medium' ? 'üü°' : 'üü¢'}
                                </span>
                            </div>
                        </div>

                        <div className="grid grid-cols-2 gap-4 mb-4 text-sm">
                            {showCustomer && request.customerName && (
                                <div>
                                    <p className="text-slate-500">Customer</p>
                                    <p className="text-white font-semibold">{request.customerName}</p>
                                </div>
                            )}
                            {showTechnician && request.technicianName && (
                                <div>
                                    <p className="text-slate-500">Technician</p>
                                    <p className="text-white font-semibold">{request.technicianName}</p>
                                </div>
                            )}
                            <div>
                                <p className="text-slate-500">Created</p>
                                <p className="text-white">{new Date(request.createdAt).toLocaleDateString()}</p>
                            </div>
                            <div>
                                <p className="text-slate-500">Priority</p>
                                <p className="text-white capitalize">{request.priority}</p>
                            </div>
                        </div>

                        {onAction && (
                            <div className="flex gap-2 mt-4">
                                {onAction}
                            </div>
                        )}
                    </div>
                );
            };

            // Landing Page
            const LandingPage = () => (
                <div>
                    <div className="gradient-bg min-h-screen">
                        <nav className="border-b border-slate-800 bg-slate-950/50 backdrop-blur-sm sticky top-0 z-50">
                            <div className="max-w-7xl mx-auto px-4 py-4">
                                <div className="flex justify-between items-center">
                                    <Logo />
                                    <div className="flex items-center gap-4">
                                        <button
                                            onClick={() => setLanguage(language === 'en' ? 'ar' : 'en')}
                                            className="px-4 py-2 rounded-lg bg-slate-800 hover:bg-slate-700 transition text-white"
                                        >
                                            {language === 'en' ? 'ÿßŸÑÿπÿ±ÿ®Ÿäÿ©' : 'English'}
                                        </button>
                                        <button
                                            onClick={() => setCurrentView('login')}
                                            className="px-6 py-2 rounded-lg bg-red-700 hover:bg-red-600 transition font-semibold text-white"
                                        >
                                            {t('signIn')}
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </nav>

                        <div className="max-w-7xl mx-auto px-4 py-20" dir={language === 'ar' ? 'rtl' : 'ltr'}>
                            <div className="text-center mb-20">
                                <h1 className="text-6xl md:text-7xl font-black text-white mb-6 leading-tight">
                                    {t('heroTitle')}
                                </h1>
                                <p className="text-xl md:text-2xl text-slate-300 mb-12 max-w-4xl mx-auto leading-relaxed">
                                    {t('heroSubtitle')}
                                </p>
                                <div className="flex flex-wrap justify-center gap-4">
                                    <button
                                        onClick={() => setCurrentView('register')}
                                        className="px-8 py-4 bg-red-700 hover:bg-red-600 text-white rounded-xl font-bold text-lg transition transform hover:scale-105"
                                    >
                                        {t('registerCustomer')}
                                    </button>
                                    <button
                                        onClick={() => setCurrentView('register-technician')}
                                        className="px-8 py-4 bg-slate-800 hover:bg-slate-700 text-white rounded-xl font-bold text-lg border-2 border-red-700 transition transform hover:scale-105"
                                    >
                                        {t('applyTechnician')}
                                    </button>
                                </div>
                            </div>

                            <div className="bg-slate-900/50 rounded-2xl p-12 border border-slate-800 mb-16">
                                <h2 className="text-4xl font-bold text-white mb-8 text-center">{t('whatWeDo')}</h2>
                                <p className="text-lg text-slate-300 leading-relaxed text-center max-w-4xl mx-auto">
                                    {t('missionText')}
                                </p>
                            </div>

                            <div className="grid md:grid-cols-3 gap-8 mb-16">
                                <div className="bg-slate-800 border border-slate-700 rounded-xl p-8 hover:border-red-700 transition card-hover">
                                    <div className="text-4xl mb-4">üéØ</div>
                                    <h3 className="text-2xl font-bold text-white mb-4">{t('smartDispatch')}</h3>
                                    <p className="text-slate-300 leading-relaxed">{t('smartDispatchDesc')}</p>
                                </div>

                                <div className="bg-slate-800 border border-slate-700 rounded-xl p-8 hover:border-red-700 transition card-hover">
                                    <div className="text-4xl mb-4">üë®‚Äçüíª</div>
                                    <h3 className="text-2xl font-bold text-white mb-4">{t('certifiedPros')}</h3>
                                    <p className="text-slate-300 leading-relaxed">{t('certifiedProsDesc')}</p>
                                </div>

                                <div className="bg-slate-800 border border-slate-700 rounded-xl p-8 hover:border-red-700 transition card-hover">
                                    <div className="text-4xl mb-4">‚ö°</div>
                                    <h3 className="text-2xl font-bold text-white mb-4">{t('availability247')}</h3>
                                    <p className="text-slate-300 leading-relaxed">{t('availability247Desc')}</p>
                                </div>
                            </div>

                            <div className="bg-gradient-to-r from-red-900/30 to-red-800/30 border border-red-700 rounded-2xl p-12">
                                <div className="text-center">
                                    <h3 className="text-3xl font-bold text-white mb-6">{t('whoWeServe')}</h3>
                                    <p className="text-lg text-slate-200 max-w-3xl mx-auto leading-relaxed mb-8">
                                        {t('whoWeServeDesc')}
                                    </p>
                                    <div className="grid md:grid-cols-4 gap-6 text-slate-300">
                                        <div className="bg-slate-900/50 rounded-lg p-4">
                                            <div className="text-2xl mb-2">üè•</div>
                                            <p className="font-semibold">{t('healthcare')}</p>
                                        </div>
                                        <div className="bg-slate-900/50 rounded-lg p-4">
                                            <div className="text-2xl mb-2">üè¢</div>
                                            <p className="font-semibold">{t('corporate')}</p>
                                        </div>
                                        <div className="bg-slate-900/50 rounded-lg p-4">
                                            <div className="text-2xl mb-2">üè´</div>
                                            <p className="font-semibold">{t('education')}</p>
                                        </div>
                                        <div className="bg-slate-900/50 rounded-lg p-4">
                                            <div className="text-2xl mb-2">üè™</div>
                                            <p className="font-semibold">{t('retail')}</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div className="mt-16 text-center">
                                <h3 className="text-3xl font-bold text-white mb-6">{t('whyChoose')}</h3>
                                <div className="grid md:grid-cols-2 gap-8 max-w-4xl mx-auto text-left">
                                    <div className="flex gap-4">
                                        <div className="text-red-500 text-2xl">‚úì</div>
                                        <div>
                                            <h4 className="text-xl font-semibold text-white mb-2">{t('realTimeTracking')}</h4>
                                            <p className="text-slate-300">{t('realTimeTrackingDesc')}</p>
                                        </div>
                                    </div>
                                    <div className="flex gap-4">
                                        <div className="text-red-500 text-2xl">‚úì</div>
                                        <div>
                                            <h4 className="text-xl font-semibold text-white mb-2">{t('qualityAssurance')}</h4>
                                            <p className="text-slate-300">{t('qualityAssuranceDesc')}</p>
                                        </div>
                                    </div>
                                    <div className="flex gap-4">
                                        <div className="text-red-500 text-2xl">‚úì</div>
                                        <div>
                                            <h4 className="text-xl font-semibold text-white mb-2">{t('rapidResponse')}</h4>
                                            <p className="text-slate-300">{t('rapidResponseDesc')}</p>
                                        </div>
                                    </div>
                                    <div className="flex gap-4">
                                        <div className="text-red-500 text-2xl">‚úì</div>
                                        <div>
                                            <h4 className="text-xl font-semibold text-white mb-2">{t('completeDoc')}</h4>
                                            <p className="text-slate-300">{t('completeDocDesc')}</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div className="bg-slate-950 border-t border-slate-800 py-8">
                        <div className="max-w-7xl mx-auto px-4 text-center">
                            <div className="flex justify-center mb-4"><Logo size="medium" /></div>
                            <p className="text-slate-400">{t('copyright')}</p>
                        </div>
                    </div>
                </div>
            );

            // Login Page
            const LoginPage = () => {
                const [email, setEmail] = useState('');
                const [password, setPassword] = useState('');

                const handleSubmit = async (e) => {
                    e.preventDefault();
                    await handleLogin(email, password);
                };

                return (
                    <div className="min-h-screen flex items-center justify-center p-4">
                        <div className="max-w-md w-full">
                            <div className="text-center mb-8">
                                <Logo />
                                <h2 className="text-3xl font-bold text-white mt-6">{t('loginTitle')}</h2>
                            </div>

                            <div className="bg-slate-800 border border-slate-700 rounded-xl p-8">
                                <form onSubmit={handleSubmit} className="space-y-4">
                                    <div>
                                        <label className="block text-sm font-medium text-slate-300 mb-2">
                                            {t('email')}
                                        </label>
                                        <input
                                            type="email"
                                            value={email}
                                            onChange={(e) => setEmail(e.target.value)}
                                            className="w-full px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:border-red-700 focus:outline-none"
                                            required
                                        />
                                    </div>

                                    <div>
                                        <label className="block text-sm font-medium text-slate-300 mb-2">
                                            {t('password')}
                                        </label>
                                        <input
                                            type="password"
                                            value={password}
                                            onChange={(e) => setPassword(e.target.value)}
                                            className="w-full px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:border-red-700 focus:outline-none"
                                            required
                                        />
                                    </div>

                                    <button
                                        type="submit"
                                        className="w-full py-3 bg-red-700 hover:bg-red-600 text-white rounded-lg font-semibold transition"
                                    >
                                        {t('login')}
                                    </button>
                                </form>

                                <div className="mt-6 text-center space-y-2">
                                    <button
                                        onClick={() => setCurrentView('register')}
                                        className="text-red-500 hover:text-red-400 transition"
                                    >
                                        {t('registerAsCustomer')}
                                    </button>
                                    <br />
                                    <button
                                        onClick={() => setCurrentView('register-technician')}
                                        className="text-red-500 hover:text-red-400 transition"
                                    >
                                        {t('applyAsTechnician')}
                                    </button>
                                </div>

                                <button
                                    onClick={() => setCurrentView('landing')}
                                    className="mt-6 text-slate-400 hover:text-white transition"
                                >
                                    {t('back')}
                                </button>

                                <div className="mt-6 pt-6 border-t border-slate-700">
                                    <p className="text-sm text-slate-400 mb-2">{t('demoAccounts')}</p>
                                    <div className="space-y-1 text-xs text-slate-500">
                                        <p>Customer: customer@test.com</p>
                                        <p>Tech: tech@test.com</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                );
            };

            // Register Customer Page
            const RegisterPage = () => {
                const [formData, setFormData] = useState({
                    name: '',
                    email: '',
                    password: '',
                    confirmPassword: '',
                    company: '',
                    phone: '',
                    address: ''
                });

                const handleSubmit = async (e) => {
                    e.preventDefault();
                    if (formData.password !== formData.confirmPassword) {
                        alert('Passwords do not match');
                        return;
                    }
                    const { confirmPassword, ...data } = formData;
                    await handleRegisterCustomer(data);
                };

                return (
                    <div className="min-h-screen flex items-center justify-center p-4">
                        <div className="max-w-md w-full">
                            <div className="text-center mb-8">
                                <Logo />
                                <h2 className="text-3xl font-bold text-white mt-6">{t('registerCustomer')}</h2>
                            </div>

                            <div className="bg-slate-800 border border-slate-700 rounded-xl p-8">
                                <form onSubmit={handleSubmit} className="space-y-4">
                                    <div>
                                        <label className="block text-sm font-medium text-slate-300 mb-2">
                                            {t('name')}
                                        </label>
                                        <input
                                            type="text"
                                            value={formData.name}
                                            onChange={(e) => setFormData({ ...formData, name: e.target.value })}
                                            className="w-full px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:border-red-700 focus:outline-none"
                                            required
                                        />
                                    </div>

                                    <div>
                                        <label className="block text-sm font-medium text-slate-300 mb-2">
                                            Company
                                        </label>
                                        <input
                                            type="text"
                                            value={formData.company}
                                            onChange={(e) => setFormData({ ...formData, company: e.target.value })}
                                            className="w-full px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:border-red-700 focus:outline-none"
                                            required
                                        />
                                    </div>

                                    <div>
                                        <label className="block text-sm font-medium text-slate-300 mb-2">
                                            {t('email')}
                                        </label>
                                        <input
                                            type="email"
                                            value={formData.email}
                                            onChange={(e) => setFormData({ ...formData, email: e.target.value })}
                                            className="w-full px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:border-red-700 focus:outline-none"
                                            required
                                        />
                                    </div>

                                    <div>
                                        <label className="block text-sm font-medium text-slate-300 mb-2">
                                            {t('phone')}
                                        </label>
                                        <input
                                            type="tel"
                                            value={formData.phone}
                                            onChange={(e) => setFormData({ ...formData, phone: e.target.value })}
                                            className="w-full px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:border-red-700 focus:outline-none"
                                            required
                                        />
                                    </div>

                                    <div>
                                        <label className="block text-sm font-medium text-slate-300 mb-2">
                                            {t('address')}
                                        </label>
                                        <textarea
                                            value={formData.address}
                                            onChange={(e) => setFormData({ ...formData, address: e.target.value })}
                                            className="w-full px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:border-red-700 focus:outline-none"
                                            rows="2"
                                            required
                                        />
                                    </div>

                                    <div>
                                        <label className="block text-sm font-medium text-slate-300 mb-2">
                                            {t('password')}
                                        </label>
                                        <input
                                            type="password"
                                            value={formData.password}
                                            onChange={(e) => setFormData({ ...formData, password: e.target.value })}
                                            className="w-full px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:border-red-700 focus:outline-none"
                                            required
                                        />
                                    </div>

                                    <div>
                                        <label className="block text-sm font-medium text-slate-300 mb-2">
                                            {t('confirmPassword')}
                                        </label>
                                        <input
                                            type="password"
                                            value={formData.confirmPassword}
                                            onChange={(e) => setFormData({ ...formData, confirmPassword: e.target.value })}
                                            className="w-full px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:border-red-700 focus:outline-none"
                                            required
                                        />
                                    </div>

                                    <button
                                        type="submit"
                                        className="w-full py-3 bg-red-700 hover:bg-red-600 text-white rounded-lg font-semibold transition"
                                    >
                                        {t('submit')}
                                    </button>
                                </form>

                                <button
                                    onClick={() => setCurrentView('landing')}
                                    className="mt-6 text-slate-400 hover:text-white transition"
                                >
                                    {t('back')}
                                </button>
                            </div>
                        </div>
                    </div>
                );
            };

            // Register Technician Page
            const RegisterTechnicianPage = () => {
                const [formData, setFormData] = useState({
                    name: '',
                    email: '',
                    password: '',
                    confirmPassword: '',
                    phone: '',
                    certifications: '',
                    experience: '',
                    specialties: ''
                });

                const handleSubmit = async (e) => {
                    e.preventDefault();
                    if (formData.password !== formData.confirmPassword) {
                        alert('Passwords do not match');
                        return;
                    }
                    const { confirmPassword, ...data } = formData;
                    await handleRegisterTechnician(data);
                };

                return (
                    <div className="min-h-screen flex items-center justify-center p-4">
                        <div className="max-w-md w-full">
                            <div className="text-center mb-8">
                                <Logo />
                                <h2 className="text-3xl font-bold text-white mt-6">{t('applyTechnician')}</h2>
                            </div>

                            <div className="bg-slate-800 border border-slate-700 rounded-xl p-8">
                                <form onSubmit={handleSubmit} className="space-y-4">
                                    <div>
                                        <label className="block text-sm font-medium text-slate-300 mb-2">
                                            {t('name')}
                                        </label>
                                        <input
                                            type="text"
                                            value={formData.name}
                                            onChange={(e) => setFormData({ ...formData, name: e.target.value })}
                                            className="w-full px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:border-red-700 focus:outline-none"
                                            required
                                        />
                                    </div>

                                    <div>
                                        <label className="block text-sm font-medium text-slate-300 mb-2">
                                            {t('email')}
                                        </label>
                                        <input
                                            type="email"
                                            value={formData.email}
                                            onChange={(e) => setFormData({ ...formData, email: e.target.value })}
                                            className="w-full px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:border-red-700 focus:outline-none"
                                            required
                                        />
                                    </div>

                                    <div>
                                        <label className="block text-sm font-medium text-slate-300 mb-2">
                                            {t('phone')}
                                        </label>
                                        <input
                                            type="tel"
                                            value={formData.phone}
                                            onChange={(e) => setFormData({ ...formData, phone: e.target.value })}
                                            className="w-full px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:border-red-700 focus:outline-none"
                                            required
                                        />
                                    </div>

                                    <div>
                                        <label className="block text-sm font-medium text-slate-300 mb-2">
                                            Certifications
                                        </label>
                                        <input
                                            type="text"
                                            value={formData.certifications}
                                            onChange={(e) => setFormData({ ...formData, certifications: e.target.value })}
                                            placeholder="e.g., CompTIA A+, Network+, Security+"
                                            className="w-full px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:border-red-700 focus:outline-none"
                                            required
                                        />
                                    </div>

                                    <div>
                                        <label className="block text-sm font-medium text-slate-300 mb-2">
                                            Years of Experience
                                        </label>
                                        <input
                                            type="number"
                                            value={formData.experience}
                                            onChange={(e) => setFormData({ ...formData, experience: e.target.value })}
                                            className="w-full px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:border-red-700 focus:outline-none"
                                            required
                                        />
                                    </div>

                                    <div>
                                        <label className="block text-sm font-medium text-slate-300 mb-2">
                                            Specialties
                                        </label>
                                        <textarea
                                            value={formData.specialties}
                                            onChange={(e) => setFormData({ ...formData, specialties: e.target.value })}
                                            placeholder="e.g., Networking, Hardware Repair, Security, Cloud Services"
                                            className="w-full px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:border-red-700 focus:outline-none"
                                            rows="2"
                                            required
                                        />
                                    </div>

                                    <div>
                                        <label className="block text-sm font-medium text-slate-300 mb-2">
                                            {t('password')}
                                        </label>
                                        <input
                                            type="password"
                                            value={formData.password}
                                            onChange={(e) => setFormData({ ...formData, password: e.target.value })}
                                            className="w-full px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:border-red-700 focus:outline-none"
                                            required
                                        />
                                    </div>

                                    <div>
                                        <label className="block text-sm font-medium text-slate-300 mb-2">
                                            {t('confirmPassword')}
                                        </label>
                                        <input
                                            type="password"
                                            value={formData.confirmPassword}
                                            onChange={(e) => setFormData({ ...formData, confirmPassword: e.target.value })}
                                            className="w-full px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:border-red-700 focus:outline-none"
                                            required
                                        />
                                    </div>

                                    <button
                                        type="submit"
                                        className="w-full py-3 bg-red-700 hover:bg-red-600 text-white rounded-lg font-semibold transition"
                                    >
                                        {t('submit')}
                                    </button>
                                </form>

                                <button
                                    onClick={() => setCurrentView('landing')}
                                    className="mt-6 text-slate-400 hover:text-white transition"
                                >
                                    {t('back')}
                                </button>
                            </div>
                        </div>
                    </div>
                );
            };

            // Customer Dashboard
            const CustomerDashboard = () => {
                const userRequests = Object.entries(requests)
                    .filter(([id, req]) => req.customerId === currentUser.id)
                    .map(([id, req]) => ({ ...req, id }));

                const stats = {
                    total: userRequests.length,
                    pending: userRequests.filter(r => r.status === 'pending').length,
                    active: userRequests.filter(r => r.status === 'active' || r.status === 'in-progress').length,
                    completed: userRequests.filter(r => r.status === 'completed' || r.status === 'reviewed').length
                };

                return (
                    <div className="min-h-screen">
                        <nav className="bg-slate-900 border-b border-slate-800 sticky top-0 z-50">
                            <div className="max-w-7xl mx-auto px-4 py-4">
                                <div className="flex justify-between items-center">
                                    <Logo size="medium" />
                                    <div className="flex items-center gap-4">
                                        <span className="text-slate-300">Welcome, {currentUser.name}</span>
                                        <button
                                            onClick={handleLogout}
                                            className="px-4 py-2 bg-red-700 hover:bg-red-600 text-white rounded-lg transition"
                                        >
                                            {t('logout')}
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </nav>

                        <div className="max-w-7xl mx-auto px-4 py-8">
                            <div className="flex justify-between items-center mb-8">
                                <h1 className="text-4xl font-bold text-white">{t('myRequests')}</h1>
                                <button
                                    onClick={() => setCurrentView('customer-new-request')}
                                    className="px-6 py-3 bg-red-700 hover:bg-red-600 text-white rounded-lg font-semibold transition"
                                >
                                    + {t('newRequest')}
                                </button>
                            </div>

                            <div className="grid md:grid-cols-4 gap-6 mb-8">
                                <StatsCard title={t('total')} value={stats.total} icon="üìä" color="blue" />
                                <StatsCard title={t('pending')} value={stats.pending} icon="‚è≥" color="yellow" />
                                <StatsCard title={t('active')} value={stats.active} icon="üîß" color="blue" />
                                <StatsCard title={t('completed')} value={stats.completed} icon="‚úì" color="green" />
                            </div>

                            <div className="space-y-4">
                                {userRequests.length === 0 ? (
                                    <div className="bg-slate-800 border border-slate-700 rounded-xl p-12 text-center">
                                        <div className="text-6xl mb-4">üìã</div>
                                        <p className="text-xl text-slate-400">No requests yet. Create your first request!</p>
                                    </div>
                                ) : (
                                    userRequests.map(request => (
                                        <RequestCard key={request.id} request={request} showTechnician={true} />
                                    ))
                                )}
                            </div>
                        </div>
                    </div>
                );
            };

            // Customer New Request
            const CustomerNewRequest = () => {
                const [formData, setFormData] = useState({
                    title: '',
                    description: '',
                    category: 'hardware',
                    priority: 'medium',
                    location: currentUser.address || ''
                });

                const handleSubmit = async (e) => {
                    e.preventDefault();
                    await handleSubmitRequest(formData);
                };

                return (
                    <div className="min-h-screen">
                        <nav className="bg-slate-900 border-b border-slate-800">
                            <div className="max-w-7xl mx-auto px-4 py-4">
                                <div className="flex justify-between items-center">
                                    <Logo size="medium" />
                                    <button
                                        onClick={() => setCurrentView('customer-dashboard')}
                                        className="text-slate-400 hover:text-white transition"
                                    >
                                        {t('back')}
                                    </button>
                                </div>
                            </div>
                        </nav>

                        <div className="max-w-3xl mx-auto px-4 py-12">
                            <h1 className="text-4xl font-bold text-white mb-8">{t('newRequest')}</h1>

                            <div className="bg-slate-800 border border-slate-700 rounded-xl p-8">
                                <form onSubmit={handleSubmit} className="space-y-6">
                                    <div>
                                        <label className="block text-sm font-medium text-slate-300 mb-2">
                                            Request Title
                                        </label>
                                        <input
                                            type="text"
                                            value={formData.title}
                                            onChange={(e) => setFormData({ ...formData, title: e.target.value })}
                                            placeholder="e.g., Computer won't turn on"
                                            className="w-full px-4 py-3 bg-slate-900 border border-slate-700 rounded-lg text-white focus:border-red-700 focus:outline-none"
                                            required
                                        />
                                    </div>

                                    <div>
                                        <label className="block text-sm font-medium text-slate-300 mb-2">
                                            Description
                                        </label>
                                        <textarea
                                            value={formData.description}
                                            onChange={(e) => setFormData({ ...formData, description: e.target.value })}
                                            placeholder="Describe the issue in detail..."
                                            className="w-full px-4 py-3 bg-slate-900 border border-slate-700 rounded-lg text-white focus:border-red-700 focus:outline-none"
                                            rows="4"
                                            required
                                        />
                                    </div>

                                    <div className="grid md:grid-cols-2 gap-6">
                                        <div>
                                            <label className="block text-sm font-medium text-slate-300 mb-2">
                                                Category
                                            </label>
                                            <select
                                                value={formData.category}
                                                onChange={(e) => setFormData({ ...formData, category: e.target.value })}
                                                className="w-full px-4 py-3 bg-slate-900 border border-slate-700 rounded-lg text-white focus:border-red-700 focus:outline-none"
                                            >
                                                <option value="hardware">Hardware</option>
                                                <option value="software">Software</option>
                                                <option value="network">Network</option>
                                                <option value="security">Security</option>
                                                <option value="other">Other</option>
                                            </select>
                                        </div>

                                        <div>
                                            <label className="block text-sm font-medium text-slate-300 mb-2">
                                                Priority
                                            </label>
                                            <select
                                                value={formData.priority}
                                                onChange={(e) => setFormData({ ...formData, priority: e.target.value })}
                                                className="w-full px-4 py-3 bg-slate-900 border border-slate-700 rounded-lg text-white focus:border-red-700 focus:outline-none"
                                            >
                                                <option value="low">Low</option>
                                                <option value="medium">Medium</option>
                                                <option value="high">High</option>
                                                <option value="critical">Critical</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div>
                                        <label className="block text-sm font-medium text-slate-300 mb-2">
                                            Location
                                        </label>
                                        <input
                                            type="text"
                                            value={formData.location}
                                            onChange={(e) => setFormData({ ...formData, location: e.target.value })}
                                            className="w-full px-4 py-3 bg-slate-900 border border-slate-700 rounded-lg text-white focus:border-red-700 focus:outline-none"
                                            required
                                        />
                                    </div>

                                    <div className="flex gap-4">
                                        <button
                                            type="button"
                                            onClick={() => setCurrentView('customer-dashboard')}
                                            className="flex-1 py-3 bg-slate-700 hover:bg-slate-600 text-white rounded-lg font-semibold transition"
                                        >
                                            {t('cancel')}
                                        </button>
                                        <button
                                            type="submit"
                                            className="flex-1 py-3 bg-red-700 hover:bg-red-600 text-white rounded-lg font-semibold transition"
                                        >
                                            {t('submit')} Request
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                );
            };

            // Technician Dashboard
            const TechnicianDashboard = () => {
                const techRequests = Object.entries(requests)
                    .filter(([id, req]) => req.technicianId === currentUser.id || req.status === 'pending')
                    .map(([id, req]) => ({ ...req, id }));

                const myJobs = techRequests.filter(r => r.technicianId === currentUser.id);
                const availableJobs = techRequests.filter(r => r.status === 'pending');

                const handleAcceptJob = async (requestId) => {
                    try {
                        const request = requests[requestId];
                        await DB.saveRequest(requestId, {
                            ...request,
                            technicianId: currentUser.id,
                            technicianName: currentUser.name,
                            status: 'active'
                        });
                        alert('Job accepted!');
                    } catch (error) {
                        console.error('Error accepting job:', error);
                        alert('Error accepting job');
                    }
                };

                const handleCompleteJob = async (requestId) => {
                    const notes = prompt('Enter completion notes:');
                    if (notes) {
                        try {
                            const request = requests[requestId];
                            await DB.saveRequest(requestId, {
                                ...request,
                                status: 'completed',
                                completionNotes: notes,
                                completedAt: new Date().toISOString()
                            });
                            alert('Job marked as completed!');
                        } catch (error) {
                            console.error('Error completing job:', error);
                            alert('Error completing job');
                        }
                    }
                };

                return (
                    <div className="min-h-screen">
                        <nav className="bg-slate-900 border-b border-slate-800 sticky top-0 z-50">
                            <div className="max-w-7xl mx-auto px-4 py-4">
                                <div className="flex justify-between items-center">
                                    <Logo size="medium" />
                                    <div className="flex items-center gap-4">
                                        <span className="text-slate-300">Welcome, {currentUser.name}</span>
                                        <button
                                            onClick={handleLogout}
                                            className="px-4 py-2 bg-red-700 hover:bg-red-600 text-white rounded-lg transition"
                                        >
                                            {t('logout')}
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </nav>

                        <div className="max-w-7xl mx-auto px-4 py-8">
                            <h1 className="text-4xl font-bold text-white mb-8">{t('myJobs')}</h1>

                            <div className="grid md:grid-cols-3 gap-6 mb-8">
                                <StatsCard 
                                    title="My Active Jobs" 
                                    value={myJobs.filter(r => r.status === 'active' || r.status === 'in-progress').length} 
                                    icon="üîß" 
                                    color="blue" 
                                />
                                <StatsCard 
                                    title="Completed" 
                                    value={myJobs.filter(r => r.status === 'completed' || r.status === 'reviewed').length} 
                                    icon="‚úì" 
                                    color="green" 
                                />
                                <StatsCard 
                                    title="Available Jobs" 
                                    value={availableJobs.length} 
                                    icon="üìã" 
                                    color="yellow" 
                                />
                            </div>

                            <div className="mb-8">
                                <h2 className="text-2xl font-bold text-white mb-4">My Active Jobs</h2>
                                <div className="space-y-4">
                                    {myJobs.length === 0 ? (
                                        <div className="bg-slate-800 border border-slate-700 rounded-xl p-12 text-center">
                                            <div className="text-6xl mb-4">üîß</div>
                                            <p className="text-xl text-slate-400">No active jobs. Check available jobs below!</p>
                                        </div>
                                    ) : (
                                        myJobs.map(request => (
                                            <RequestCard 
                                                key={request.id} 
                                                request={request} 
                                                showCustomer={true}
                                                onAction={
                                                    (request.status === 'active' || request.status === 'in-progress') && (
                                                        <button
                                                            onClick={() => handleCompleteJob(request.id)}
                                                            className="px-4 py-2 bg-green-700 hover:bg-green-600 text-white rounded-lg font-semibold transition"
                                                        >
                                                            Mark Complete
                                                        </button>
                                                    )
                                                }
                                            />
                                        ))
                                    )}
                                </div>
                            </div>

                            <div>
                                <h2 className="text-2xl font-bold text-white mb-4">Available Jobs</h2>
                                <div className="space-y-4">
                                    {availableJobs.length === 0 ? (
                                        <div className="bg-slate-800 border border-slate-700 rounded-xl p-12 text-center">
                                            <div className="text-6xl mb-4">üìã</div>
                                            <p className="text-xl text-slate-400">No available jobs at the moment.</p>
                                        </div>
                                    ) : (
                                        availableJobs.map(request => (
                                            <RequestCard 
                                                key={request.id} 
                                                request={request} 
                                                showCustomer={true}
                                                onAction={
                                                    <button
                                                        onClick={() => handleAcceptJob(request.id)}
                                                        className="px-4 py-2 bg-blue-700 hover:bg-blue-600 text-white rounded-lg font-semibold transition"
                                                    >
                                                        Accept Job
                                                    </button>
                                                }
                                            />
                                        ))
                                    )}
                                </div>
                            </div>
                        </div>
                    </div>
                );
            };

            // Admin Dashboard
            const AdminDashboard = () => {
                const allRequests = Object.entries(requests).map(([id, req]) => ({ ...req, id }));
                const allTechnicians = Object.entries(technicians).map(([id, tech]) => ({ ...tech, id }));
                const allCustomers = Object.entries(customers).map(([id, cust]) => ({ ...cust, id }));

                const stats = {
                    totalRequests: allRequests.length,
                    pendingRequests: allRequests.filter(r => r.status === 'pending').length,
                    activeRequests: allRequests.filter(r => r.status === 'active' || r.status === 'in-progress').length,
                    completedRequests: allRequests.filter(r => r.status === 'completed' || r.status === 'reviewed').length,
                    activeTechnicians: allTechnicians.filter(t => t.status === 'approved').length,
                    pendingTechnicians: allTechnicians.filter(t => t.status === 'pending').length,
                    totalCustomers: allCustomers.length
                };

                return (
                    <div className="min-h-screen">
                        <nav className="bg-slate-900 border-b border-slate-800 sticky top-0 z-50">
                            <div className="max-w-7xl mx-auto px-4 py-4">
                                <div className="flex justify-between items-center">
                                    <Logo size="medium" />
                                    <div className="flex items-center gap-4">
                                        <span className="text-slate-300">Admin Panel - {currentUser.name}</span>
                                        <button
                                            onClick={handleLogout}
                                            className="px-4 py-2 bg-red-700 hover:bg-red-600 text-white rounded-lg transition"
                                        >
                                            {t('logout')}
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </nav>

                        <div className="max-w-7xl mx-auto px-4 py-8">
                            <h1 className="text-4xl font-bold text-white mb-2">Admin Dashboard</h1>
                            <p className="text-slate-400 mb-8">Manage your IT dispatch platform</p>

                            <div className="grid md:grid-cols-4 gap-6 mb-8">
                                <StatsCard title="Total Requests" value={stats.totalRequests} icon="üìä" color="blue" />
                                <StatsCard title="Pending Requests" value={stats.pendingRequests} icon="‚è≥" color="yellow" />
                                <StatsCard title="Active Technicians" value={stats.activeTechnicians} icon="üë®‚Äçüíª" color="green" />
                                <StatsCard title="Total Customers" value={stats.totalCustomers} icon="üë•" color="purple" />
                            </div>

                            <div className="grid md:grid-cols-3 gap-6 mb-8">
                                <button
                                    onClick={() => setCurrentView('admin-requests')}
                                    className="bg-slate-800 border border-slate-700 rounded-xl p-8 hover:border-red-700 transition card-hover text-left"
                                >
                                    <div className="flex justify-between items-start mb-4">
                                        <div className="text-4xl">üìã</div>
                                        <div className="text-right">
                                            <div className="text-sm text-slate-400">Pending</div>
                                            <div className="text-2xl font-bold text-yellow-500">{stats.pendingRequests}</div>
                                        </div>
                                    </div>
                                    <h3 className="text-2xl font-bold text-white mb-2">Manage Requests</h3>
                                    <p className="text-slate-400">View, assign, and manage all service requests</p>
                                </button>

                                <button
                                    onClick={() => setCurrentView('admin-technicians')}
                                    className="bg-slate-800 border border-slate-700 rounded-xl p-8 hover:border-red-700 transition card-hover text-left"
                                >
                                    <div className="flex justify-between items-start mb-4">
                                        <div className="text-4xl">üë®‚Äçüíª</div>
                                        <div className="text-right">
                                            <div className="text-sm text-slate-400">Pending</div>
                                            <div className="text-2xl font-bold text-yellow-500">{stats.pendingTechnicians}</div>
                                        </div>
                                    </div>
                                    <h3 className="text-2xl font-bold text-white mb-2">Manage Technicians</h3>
                                    <p className="text-slate-400">Approve, edit, suspend, or delete technicians</p>
                                </button>

                                <button
                                    onClick={() => setCurrentView('admin-customers')}
                                    className="bg-slate-800 border border-slate-700 rounded-xl p-8 hover:border-red-700 transition card-hover text-left"
                                >
                                    <div className="flex justify-between items-start mb-4">
                                        <div className="text-4xl">üë•</div>
                                        <div className="text-right">
                                            <div className="text-sm text-slate-400">Active</div>
                                            <div className="text-2xl font-bold text-green-500">{stats.totalCustomers}</div>
                                        </div>
                                    </div>
                                    <h3 className="text-2xl font-bold text-white mb-2">Manage Customers</h3>
                                    <p className="text-slate-400">View, edit, suspend, or delete customer accounts</p>
                                </button>
                            </div>

                            <div className="bg-slate-800 border border-slate-700 rounded-xl p-6">
                                <h2 className="text-xl font-bold text-white mb-4">Recent Activity</h2>
                                <div className="space-y-3">
                                    {allRequests.slice(0, 5).map(req => (
                                        <div key={req.id} className="flex items-center justify-between p-3 bg-slate-900 rounded-lg">
                                            <div className="flex items-center gap-3">
                                                <span className="text-2xl">
                                                    {req.status === 'pending' ? '‚è≥' : req.status === 'active' ? 'üîß' : '‚úÖ'}
                                                </span>
                                                <div>
                                                    <p className="text-white font-semibold">{req.title}</p>
                                                    <p className="text-sm text-slate-400">{req.customerName}</p>
                                                </div>
                                            </div>
                                            <span className="text-sm text-slate-400">
                                                {new Date(req.createdAt).toLocaleDateString()}
                                            </span>
                                        </div>
                                    ))}
                                    {allRequests.length === 0 && (
                                        <p className="text-center text-slate-400 py-4">No requests yet</p>
                                    )}
                                </div>
                            </div>
                        </div>
                    </div>
                );
            };

            // Admin Requests Page
            const AdminRequestsPage = () => {
                const allRequests = Object.entries(requests).map(([id, req]) => ({ ...req, id }));
                const [filterStatus, setFilterStatus] = useState('all');
                const [filterPriority, setFilterPriority] = useState('all');
                const [searchTerm, setSearchTerm] = useState('');
                const [selectedRequest, setSelectedRequest] = useState(null);
                const [showAssignModal, setShowAssignModal] = useState(false);

                // Filter and search requests
                const filteredRequests = allRequests.filter(req => {
                    const matchesStatus = filterStatus === 'all' || req.status === filterStatus;
                    const matchesPriority = filterPriority === 'all' || req.priority === filterPriority;
                    const matchesSearch = searchTerm === '' || 
                        req.title.toLowerCase().includes(searchTerm.toLowerCase()) ||
                        req.customerName.toLowerCase().includes(searchTerm.toLowerCase()) ||
                        (req.technicianName && req.technicianName.toLowerCase().includes(searchTerm.toLowerCase()));
                    return matchesStatus && matchesPriority && matchesSearch;
                });

                const handleAssignTechnician = async (requestId, technicianId) => {
                    try {
                        const request = requests[requestId];
                        const technician = technicians[technicianId];
                        
                        await DB.saveRequest(requestId, {
                            ...request,
                            technicianId: technicianId,
                            technicianName: technician.name,
                            status: 'active',
                            assignedAt: new Date().toISOString()
                        });
                        alert('Technician assigned successfully!');
                        setShowAssignModal(false);
                        setSelectedRequest(null);
                    } catch (error) {
                        console.error('Error assigning technician:', error);
                        alert('Error assigning technician');
                    }
                };

                const handleDeleteRequest = async (requestId) => {
                    if (confirm('Are you sure you want to delete this request? This cannot be undone.')) {
                        try {
                            await DB.deleteRequest(requestId);
                            alert('Request deleted successfully!');
                        } catch (error) {
                            console.error('Error deleting request:', error);
                            alert('Error deleting request');
                        }
                    }
                };

                const handleCancelAssignment = async (requestId) => {
                    if (confirm('Cancel this assignment and return to pending status?')) {
                        try {
                            const request = requests[requestId];
                            await DB.saveRequest(requestId, {
                                ...request,
                                technicianId: null,
                                technicianName: null,
                                status: 'pending',
                                assignedAt: null
                            });
                            alert('Assignment cancelled');
                        } catch (error) {
                            console.error('Error cancelling assignment:', error);
                            alert('Error cancelling assignment');
                        }
                    }
                };

                const availableTechnicians = Object.entries(technicians)
                    .filter(([id, tech]) => tech.status === 'approved')
                    .map(([id, tech]) => ({ ...tech, id }));

                return (
                    <div className="min-h-screen">
                        <nav className="bg-slate-900 border-b border-slate-800">
                            <div className="max-w-7xl mx-auto px-4 py-4">
                                <div className="flex justify-between items-center">
                                    <Logo size="medium" />
                                    <button
                                        onClick={() => setCurrentView('admin-dashboard')}
                                        className="text-slate-400 hover:text-white transition"
                                    >
                                        {t('back')}
                                    </button>
                                </div>
                            </div>
                        </nav>

                        <div className="max-w-7xl mx-auto px-4 py-8">
                            <div className="flex justify-between items-center mb-6">
                                <div>
                                    <h1 className="text-4xl font-bold text-white mb-2">Manage Requests</h1>
                                    <p className="text-slate-400">View, assign, and manage all service requests</p>
                                </div>
                                <div className="text-right">
                                    <div className="text-3xl font-bold text-white">{filteredRequests.length}</div>
                                    <div className="text-sm text-slate-400">Total Requests</div>
                                </div>
                            </div>

                            {/* Filters */}
                            <div className="bg-slate-800 border border-slate-700 rounded-xl p-6 mb-6">
                                <div className="grid md:grid-cols-3 gap-4">
                                    <div>
                                        <label className="block text-sm font-medium text-slate-300 mb-2">
                                            Search
                                        </label>
                                        <input
                                            type="text"
                                            value={searchTerm}
                                            onChange={(e) => setSearchTerm(e.target.value)}
                                            placeholder="Search by title, customer, technician..."
                                            className="w-full px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:border-red-700 focus:outline-none"
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-slate-300 mb-2">
                                            Status
                                        </label>
                                        <select
                                            value={filterStatus}
                                            onChange={(e) => setFilterStatus(e.target.value)}
                                            className="w-full px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:border-red-700 focus:outline-none"
                                        >
                                            <option value="all">All Statuses</option>
                                            <option value="pending">Pending</option>
                                            <option value="active">Active</option>
                                            <option value="in-progress">In Progress</option>
                                            <option value="completed">Completed</option>
                                            <option value="reviewed">Reviewed</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-slate-300 mb-2">
                                            Priority
                                        </label>
                                        <select
                                            value={filterPriority}
                                            onChange={(e) => setFilterPriority(e.target.value)}
                                            className="w-full px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:border-red-700 focus:outline-none"
                                        >
                                            <option value="all">All Priorities</option>
                                            <option value="low">Low</option>
                                            <option value="medium">Medium</option>
                                            <option value="high">High</option>
                                            <option value="critical">Critical</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            {/* Requests List */}
                            <div className="space-y-4">
                                {filteredRequests.length === 0 ? (
                                    <div className="bg-slate-800 border border-slate-700 rounded-xl p-12 text-center">
                                        <div className="text-6xl mb-4">üìã</div>
                                        <p className="text-xl text-slate-400">No requests found</p>
                                    </div>
                                ) : (
                                    filteredRequests.map(request => (
                                        <div key={request.id} className="bg-slate-800 border border-slate-700 rounded-xl p-6 hover:border-red-700 transition card-hover">
                                            <div className="flex justify-between items-start mb-4">
                                                <div className="flex-1">
                                                    <div className="flex items-center gap-3 mb-2">
                                                        <h3 className="text-xl font-bold text-white">{request.title}</h3>
                                                        <span className={`px-3 py-1 rounded-full text-xs font-semibold ${
                                                            request.status === 'pending' ? 'bg-yellow-500/20 text-yellow-500 border border-yellow-500/30' :
                                                            request.status === 'active' || request.status === 'in-progress' ? 'bg-blue-500/20 text-blue-500 border border-blue-500/30' :
                                                            request.status === 'completed' || request.status === 'reviewed' ? 'bg-green-500/20 text-green-500 border border-green-500/30' :
                                                            'bg-slate-500/20 text-slate-500 border border-slate-500/30'
                                                        }`}>
                                                            {request.status}
                                                        </span>
                                                        <span className={`text-2xl ${
                                                            request.priority === 'critical' ? 'text-red-400' :
                                                            request.priority === 'high' ? 'text-orange-400' :
                                                            request.priority === 'medium' ? 'text-yellow-400' :
                                                            'text-green-400'
                                                        }`}>
                                                            {request.priority === 'critical' ? 'üî¥' : request.priority === 'high' ? 'üü†' : request.priority === 'medium' ? 'üü°' : 'üü¢'}
                                                        </span>
                                                    </div>
                                                    <p className="text-slate-400 mb-3">{request.description}</p>
                                                    <div className="grid md:grid-cols-4 gap-4 text-sm">
                                                        <div>
                                                            <p className="text-slate-500">Customer</p>
                                                            <p className="text-white font-semibold">{request.customerName}</p>
                                                        </div>
                                                        <div>
                                                            <p className="text-slate-500">Technician</p>
                                                            <p className="text-white font-semibold">{request.technicianName || 'Unassigned'}</p>
                                                        </div>
                                                        <div>
                                                            <p className="text-slate-500">Category</p>
                                                            <p className="text-white capitalize">{request.category}</p>
                                                        </div>
                                                        <div>
                                                            <p className="text-slate-500">Created</p>
                                                            <p className="text-white">{new Date(request.createdAt).toLocaleDateString()}</p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div className="flex gap-2 flex-wrap">
                                                {request.status === 'pending' && (
                                                    <button
                                                        onClick={() => {
                                                            setSelectedRequest(request);
                                                            setShowAssignModal(true);
                                                        }}
                                                        className="px-4 py-2 bg-blue-700 hover:bg-blue-600 text-white rounded-lg font-semibold transition text-sm"
                                                    >
                                                        Assign Technician
                                                    </button>
                                                )}
                                                {request.technicianId && (request.status === 'active' || request.status === 'in-progress') && (
                                                    <button
                                                        onClick={() => handleCancelAssignment(request.id)}
                                                        className="px-4 py-2 bg-orange-700 hover:bg-orange-600 text-white rounded-lg font-semibold transition text-sm"
                                                    >
                                                        Cancel Assignment
                                                    </button>
                                                )}
                                                <button
                                                    onClick={() => handleDeleteRequest(request.id)}
                                                    className="px-4 py-2 bg-red-700 hover:bg-red-600 text-white rounded-lg font-semibold transition text-sm"
                                                >
                                                    Delete Request
                                                </button>
                                            </div>
                                        </div>
                                    ))
                                )}
                            </div>

                            {/* Assign Technician Modal */}
                            {showAssignModal && selectedRequest && (
                                <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4">
                                    <div className="bg-slate-800 border border-slate-700 rounded-xl p-8 max-w-2xl w-full max-h-[80vh] overflow-y-auto">
                                        <h2 className="text-2xl font-bold text-white mb-4">Assign Technician</h2>
                                        <p className="text-slate-400 mb-6">Select a technician for: {selectedRequest.title}</p>
                                        
                                        <div className="space-y-3">
                                            {availableTechnicians.length === 0 ? (
                                                <p className="text-center text-slate-400 py-8">No approved technicians available</p>
                                            ) : (
                                                availableTechnicians.map(tech => (
                                                    <button
                                                        key={tech.id}
                                                        onClick={() => handleAssignTechnician(selectedRequest.id, tech.id)}
                                                        className="w-full bg-slate-900 border border-slate-700 rounded-lg p-4 hover:border-blue-500 transition text-left"
                                                    >
                                                        <div className="flex justify-between items-start">
                                                            <div>
                                                                <p className="text-white font-bold">{tech.name}</p>
                                                                <p className="text-sm text-slate-400">{tech.email}</p>
                                                                <p className="text-sm text-slate-500 mt-1">Certifications: {tech.certifications}</p>
                                                                <p className="text-sm text-slate-500">Experience: {tech.experience} years</p>
                                                            </div>
                                                            <span className="text-green-500 text-xl">‚úì</span>
                                                        </div>
                                                    </button>
                                                ))
                                            )}
                                        </div>

                                        <button
                                            onClick={() => {
                                                setShowAssignModal(false);
                                                setSelectedRequest(null);
                                            }}
                                            className="w-full mt-6 py-3 bg-slate-700 hover:bg-slate-600 text-white rounded-lg font-semibold transition"
                                        >
                                            Cancel
                                        </button>
                                    </div>
                                </div>
                            )}
                        </div>
                    </div>
                );
            };

            // Admin Technicians Page
            const AdminTechniciansPage = () => {
                const allTechnicians = Object.entries(technicians).map(([id, tech]) => ({ ...tech, id }));
                const [filterStatus, setFilterStatus] = useState('all');
                const [searchTerm, setSearchTerm] = useState('');
                const [editingTech, setEditingTech] = useState(null);
                const [showEditModal, setShowEditModal] = useState(false);

                // Filter and search
                const filteredTechnicians = allTechnicians.filter(tech => {
                    const matchesStatus = filterStatus === 'all' || tech.status === filterStatus;
                    const matchesSearch = searchTerm === '' || 
                        tech.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
                        tech.email.toLowerCase().includes(searchTerm.toLowerCase()) ||
                        (tech.certifications && tech.certifications.toLowerCase().includes(searchTerm.toLowerCase()));
                    return matchesStatus && matchesSearch;
                });

                const handleApproveTechnician = async (techId) => {
                    try {
                        const tech = technicians[techId];
                        await DB.saveTechnician(techId, {
                            ...tech,
                            status: 'approved',
                            approvedAt: new Date().toISOString()
                        });
                        alert('Technician approved!');
                    } catch (error) {
                        console.error('Error approving technician:', error);
                        alert('Error approving technician');
                    }
                };

                const handleSuspendTechnician = async (techId) => {
                    if (confirm('Suspend this technician? They will not be able to accept new jobs.')) {
                        try {
                            const tech = technicians[techId];
                            await DB.saveTechnician(techId, {
                                ...tech,
                                status: 'suspended',
                                suspendedAt: new Date().toISOString()
                            });
                            alert('Technician suspended');
                        } catch (error) {
                            console.error('Error suspending technician:', error);
                            alert('Error suspending technician');
                        }
                    }
                };

                const handleReactivateTechnician = async (techId) => {
                    try {
                        const tech = technicians[techId];
                        await DB.saveTechnician(techId, {
                            ...tech,
                            status: 'approved',
                            reactivatedAt: new Date().toISOString()
                        });
                        alert('Technician reactivated');
                    } catch (error) {
                        console.error('Error reactivating technician:', error);
                        alert('Error reactivating technician');
                    }
                };

                const handleDeleteTechnician = async (techId) => {
                    // Check if technician has active jobs
                    const activeJobs = Object.values(requests).filter(r => 
                        r.technicianId === techId && (r.status === 'active' || r.status === 'in-progress')
                    );
                    
                    if (activeJobs.length > 0) {
                        alert(`Cannot delete technician with ${activeJobs.length} active job(s). Please reassign or complete them first.`);
                        return;
                    }

                    if (confirm('Are you sure you want to permanently delete this technician? This cannot be undone.')) {
                        try {
                            await DB.deleteTechnician(techId);
                            alert('Technician deleted');
                        } catch (error) {
                            console.error('Error deleting technician:', error);
                            alert('Error deleting technician');
                        }
                    }
                };

                const handleEditTechnician = (tech) => {
                    setEditingTech({...tech});
                    setShowEditModal(true);
                };

                const handleSaveEdit = async () => {
                    try {
                        const { id, ...techData } = editingTech;
                        await DB.saveTechnician(id, techData);
                        alert('Technician updated successfully!');
                        setShowEditModal(false);
                        setEditingTech(null);
                    } catch (error) {
                        console.error('Error updating technician:', error);
                        alert('Error updating technician');
                    }
                };

                const stats = {
                    total: allTechnicians.length,
                    pending: allTechnicians.filter(t => t.status === 'pending').length,
                    approved: allTechnicians.filter(t => t.status === 'approved').length,
                    suspended: allTechnicians.filter(t => t.status === 'suspended').length
                };

                return (
                    <div className="min-h-screen">
                        <nav className="bg-slate-900 border-b border-slate-800">
                            <div className="max-w-7xl mx-auto px-4 py-4">
                                <div className="flex justify-between items-center">
                                    <Logo size="medium" />
                                    <button
                                        onClick={() => setCurrentView('admin-dashboard')}
                                        className="text-slate-400 hover:text-white transition"
                                    >
                                        {t('back')}
                                    </button>
                                </div>
                            </div>
                        </nav>

                        <div className="max-w-7xl mx-auto px-4 py-8">
                            <div className="flex justify-between items-center mb-6">
                                <div>
                                    <h1 className="text-4xl font-bold text-white mb-2">Manage Technicians</h1>
                                    <p className="text-slate-400">Approve, edit, suspend, or delete technicians</p>
                                </div>
                            </div>

                            {/* Stats */}
                            <div className="grid md:grid-cols-4 gap-4 mb-6">
                                <div className="bg-slate-800 border border-slate-700 rounded-lg p-4">
                                    <p className="text-slate-400 text-sm">Total</p>
                                    <p className="text-3xl font-bold text-white">{stats.total}</p>
                                </div>
                                <div className="bg-slate-800 border border-yellow-500/30 rounded-lg p-4">
                                    <p className="text-slate-400 text-sm">Pending</p>
                                    <p className="text-3xl font-bold text-yellow-500">{stats.pending}</p>
                                </div>
                                <div className="bg-slate-800 border border-green-500/30 rounded-lg p-4">
                                    <p className="text-slate-400 text-sm">Approved</p>
                                    <p className="text-3xl font-bold text-green-500">{stats.approved}</p>
                                </div>
                                <div className="bg-slate-800 border border-red-500/30 rounded-lg p-4">
                                    <p className="text-slate-400 text-sm">Suspended</p>
                                    <p className="text-3xl font-bold text-red-500">{stats.suspended}</p>
                                </div>
                            </div>

                            {/* Filters */}
                            <div className="bg-slate-800 border border-slate-700 rounded-xl p-6 mb-6">
                                <div className="grid md:grid-cols-2 gap-4">
                                    <div>
                                        <label className="block text-sm font-medium text-slate-300 mb-2">Search</label>
                                        <input
                                            type="text"
                                            value={searchTerm}
                                            onChange={(e) => setSearchTerm(e.target.value)}
                                            placeholder="Search by name, email, certifications..."
                                            className="w-full px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:border-red-700 focus:outline-none"
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-slate-300 mb-2">Status</label>
                                        <select
                                            value={filterStatus}
                                            onChange={(e) => setFilterStatus(e.target.value)}
                                            className="w-full px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:border-red-700 focus:outline-none"
                                        >
                                            <option value="all">All Statuses</option>
                                            <option value="pending">Pending Approval</option>
                                            <option value="approved">Approved</option>
                                            <option value="suspended">Suspended</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            {/* Technicians List */}
                            <div className="space-y-4">
                                {filteredTechnicians.length === 0 ? (
                                    <div className="bg-slate-800 border border-slate-700 rounded-xl p-12 text-center">
                                        <div className="text-6xl mb-4">üë®‚Äçüíª</div>
                                        <p className="text-xl text-slate-400">No technicians found</p>
                                    </div>
                                ) : (
                                    filteredTechnicians.map(tech => (
                                        <div key={tech.id} className="bg-slate-800 border border-slate-700 rounded-xl p-6 hover:border-red-700 transition card-hover">
                                            <div className="flex justify-between items-start mb-4">
                                                <div className="flex-1">
                                                    <div className="flex items-center gap-3 mb-3">
                                                        <h3 className="text-xl font-bold text-white">{tech.name}</h3>
                                                        <span className={`px-3 py-1 rounded-full text-xs font-semibold border ${
                                                            tech.status === 'approved' ? 'bg-green-500/20 text-green-500 border-green-500/30' : 
                                                            tech.status === 'suspended' ? 'bg-red-500/20 text-red-500 border-red-500/30' :
                                                            'bg-yellow-500/20 text-yellow-500 border-yellow-500/30'
                                                        }`}>
                                                            {tech.status}
                                                        </span>
                                                    </div>
                                                    <div className="grid md:grid-cols-2 gap-4 text-sm">
                                                        <div>
                                                            <p className="text-slate-500">Email</p>
                                                            <p className="text-white">{tech.email}</p>
                                                        </div>
                                                        <div>
                                                            <p className="text-slate-500">Phone</p>
                                                            <p className="text-white">{tech.phone}</p>
                                                        </div>
                                                        <div>
                                                            <p className="text-slate-500">Certifications</p>
                                                            <p className="text-white">{tech.certifications}</p>
                                                        </div>
                                                        <div>
                                                            <p className="text-slate-500">Experience</p>
                                                            <p className="text-white">{tech.experience} years</p>
                                                        </div>
                                                        <div className="md:col-span-2">
                                                            <p className="text-slate-500">Specialties</p>
                                                            <p className="text-white">{tech.specialties}</p>
                                                        </div>
                                                        <div>
                                                            <p className="text-slate-500">Joined</p>
                                                            <p className="text-white">{new Date(tech.createdAt).toLocaleDateString()}</p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div className="flex gap-2 flex-wrap">
                                                {tech.status === 'pending' && (
                                                    <>
                                                        <button
                                                            onClick={() => handleApproveTechnician(tech.id)}
                                                            className="px-4 py-2 bg-green-700 hover:bg-green-600 text-white rounded-lg font-semibold transition text-sm"
                                                        >
                                                            ‚úì Approve
                                                        </button>
                                                        <button
                                                            onClick={() => handleDeleteTechnician(tech.id)}
                                                            className="px-4 py-2 bg-red-700 hover:bg-red-600 text-white rounded-lg font-semibold transition text-sm"
                                                        >
                                                            ‚úó Reject & Delete
                                                        </button>
                                                    </>
                                                )}
                                                {tech.status === 'approved' && (
                                                    <>
                                                        <button
                                                            onClick={() => handleEditTechnician(tech)}
                                                            className="px-4 py-2 bg-blue-700 hover:bg-blue-600 text-white rounded-lg font-semibold transition text-sm"
                                                        >
                                                            ‚úé Edit
                                                        </button>
                                                        <button
                                                            onClick={() => handleSuspendTechnician(tech.id)}
                                                            className="px-4 py-2 bg-orange-700 hover:bg-orange-600 text-white rounded-lg font-semibold transition text-sm"
                                                        >
                                                            ‚äó Suspend
                                                        </button>
                                                        <button
                                                            onClick={() => handleDeleteTechnician(tech.id)}
                                                            className="px-4 py-2 bg-red-700 hover:bg-red-600 text-white rounded-lg font-semibold transition text-sm"
                                                        >
                                                            üóë Delete
                                                        </button>
                                                    </>
                                                )}
                                                {tech.status === 'suspended' && (
                                                    <>
                                                        <button
                                                            onClick={() => handleReactivateTechnician(tech.id)}
                                                            className="px-4 py-2 bg-green-700 hover:bg-green-600 text-white rounded-lg font-semibold transition text-sm"
                                                        >
                                                            ‚Üª Reactivate
                                                        </button>
                                                        <button
                                                            onClick={() => handleDeleteTechnician(tech.id)}
                                                            className="px-4 py-2 bg-red-700 hover:bg-red-600 text-white rounded-lg font-semibold transition text-sm"
                                                        >
                                                            üóë Delete
                                                        </button>
                                                    </>
                                                )}
                                            </div>
                                        </div>
                                    ))
                                )}
                            </div>

                            {/* Edit Modal */}
                            {showEditModal && editingTech && (
                                <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4">
                                    <div className="bg-slate-800 border border-slate-700 rounded-xl p-8 max-w-2xl w-full max-h-[80vh] overflow-y-auto">
                                        <h2 className="text-2xl font-bold text-white mb-6">Edit Technician</h2>
                                        
                                        <div className="space-y-4">
                                            <div>
                                                <label className="block text-sm font-medium text-slate-300 mb-2">Name</label>
                                                <input
                                                    type="text"
                                                    value={editingTech.name}
                                                    onChange={(e) => setEditingTech({...editingTech, name: e.target.value})}
                                                    className="w-full px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:border-red-700 focus:outline-none"
                                                />
                                            </div>
                                            <div>
                                                <label className="block text-sm font-medium text-slate-300 mb-2">Email</label>
                                                <input
                                                    type="email"
                                                    value={editingTech.email}
                                                    onChange={(e) => setEditingTech({...editingTech, email: e.target.value})}
                                                    className="w-full px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:border-red-700 focus:outline-none"
                                                />
                                            </div>
                                            <div>
                                                <label className="block text-sm font-medium text-slate-300 mb-2">Phone</label>
                                                <input
                                                    type="tel"
                                                    value={editingTech.phone}
                                                    onChange={(e) => setEditingTech({...editingTech, phone: e.target.value})}
                                                    className="w-full px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:border-red-700 focus:outline-none"
                                                />
                                            </div>
                                            <div>
                                                <label className="block text-sm font-medium text-slate-300 mb-2">Certifications</label>
                                                <input
                                                    type="text"
                                                    value={editingTech.certifications}
                                                    onChange={(e) => setEditingTech({...editingTech, certifications: e.target.value})}
                                                    className="w-full px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:border-red-700 focus:outline-none"
                                                />
                                            </div>
                                            <div>
                                                <label className="block text-sm font-medium text-slate-300 mb-2">Experience (years)</label>
                                                <input
                                                    type="number"
                                                    value={editingTech.experience}
                                                    onChange={(e) => setEditingTech({...editingTech, experience: e.target.value})}
                                                    className="w-full px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:border-red-700 focus:outline-none"
                                                />
                                            </div>
                                            <div>
                                                <label className="block text-sm font-medium text-slate-300 mb-2">Specialties</label>
                                                <textarea
                                                    value={editingTech.specialties}
                                                    onChange={(e) => setEditingTech({...editingTech, specialties: e.target.value})}
                                                    className="w-full px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:border-red-700 focus:outline-none"
                                                    rows="3"
                                                />
                                            </div>
                                        </div>

                                        <div className="flex gap-3 mt-6">
                                            <button
                                                onClick={handleSaveEdit}
                                                className="flex-1 py-3 bg-green-700 hover:bg-green-600 text-white rounded-lg font-semibold transition"
                                            >
                                                Save Changes
                                            </button>
                                            <button
                                                onClick={() => {
                                                    setShowEditModal(false);
                                                    setEditingTech(null);
                                                }}
                                                className="flex-1 py-3 bg-slate-700 hover:bg-slate-600 text-white rounded-lg font-semibold transition"
                                            >
                                                Cancel
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            )}
                        </div>
                    </div>
                );
            };

            // Admin Customers Page
            const AdminCustomersPage = () => {
                const allCustomers = Object.entries(customers).map(([id, cust]) => ({ ...cust, id }));
                const [searchTerm, setSearchTerm] = useState('');
                const [editingCustomer, setEditingCustomer] = useState(null);
                const [showEditModal, setShowEditModal] = useState(false);

                // Filter and search
                const filteredCustomers = allCustomers.filter(customer => {
                    const matchesSearch = searchTerm === '' || 
                        customer.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
                        customer.email.toLowerCase().includes(searchTerm.toLowerCase()) ||
                        (customer.company && customer.company.toLowerCase().includes(searchTerm.toLowerCase()));
                    return matchesSearch;
                });

                const handleEditCustomer = (customer) => {
                    setEditingCustomer({...customer});
                    setShowEditModal(true);
                };

                const handleSaveEdit = async () => {
                    try {
                        const { id, ...customerData } = editingCustomer;
                        await DB.saveCustomer(id, customerData);
                        alert('Customer updated successfully!');
                        setShowEditModal(false);
                        setEditingCustomer(null);
                    } catch (error) {
                        console.error('Error updating customer:', error);
                        alert('Error updating customer');
                    }
                };

                const handleDeleteCustomer = async (customerId) => {
                    // Check if customer has active requests
                    const activeRequests = Object.values(requests).filter(r => 
                        r.customerId === customerId && (r.status === 'pending' || r.status === 'active' || r.status === 'in-progress')
                    );
                    
                    if (activeRequests.length > 0) {
                        if (!confirm(`This customer has ${activeRequests.length} active request(s). Delete anyway? (Requests will remain but customer info will be lost)`)) {
                            return;
                        }
                    }

                    if (confirm('Are you sure you want to permanently delete this customer? This cannot be undone.')) {
                        try {
                            await DB.deleteCustomer(customerId);
                            alert('Customer deleted');
                        } catch (error) {
                            console.error('Error deleting customer:', error);
                            alert('Error deleting customer');
                        }
                    }
                };

                const getCustomerStats = (customerId) => {
                    const customerRequests = Object.values(requests).filter(r => r.customerId === customerId);
                    return {
                        total: customerRequests.length,
                        pending: customerRequests.filter(r => r.status === 'pending').length,
                        active: customerRequests.filter(r => r.status === 'active' || r.status === 'in-progress').length,
                        completed: customerRequests.filter(r => r.status === 'completed' || r.status === 'reviewed').length
                    };
                };

                return (
                    <div className="min-h-screen">
                        <nav className="bg-slate-900 border-b border-slate-800">
                            <div className="max-w-7xl mx-auto px-4 py-4">
                                <div className="flex justify-between items-center">
                                    <Logo size="medium" />
                                    <button
                                        onClick={() => setCurrentView('admin-dashboard')}
                                        className="text-slate-400 hover:text-white transition"
                                    >
                                        {t('back')}
                                    </button>
                                </div>
                            </div>
                        </nav>

                        <div className="max-w-7xl mx-auto px-4 py-8">
                            <div className="flex justify-between items-center mb-6">
                                <div>
                                    <h1 className="text-4xl font-bold text-white mb-2">Manage Customers</h1>
                                    <p className="text-slate-400">View, edit, or delete customer accounts</p>
                                </div>
                                <div className="text-right">
                                    <div className="text-3xl font-bold text-white">{filteredCustomers.length}</div>
                                    <div className="text-sm text-slate-400">Total Customers</div>
                                </div>
                            </div>

                            {/* Search */}
                            <div className="bg-slate-800 border border-slate-700 rounded-xl p-6 mb-6">
                                <div>
                                    <label className="block text-sm font-medium text-slate-300 mb-2">Search</label>
                                    <input
                                        type="text"
                                        value={searchTerm}
                                        onChange={(e) => setSearchTerm(e.target.value)}
                                        placeholder="Search by name, email, or company..."
                                        className="w-full px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:border-red-700 focus:outline-none"
                                    />
                                </div>
                            </div>

                            {/* Customers List */}
                            <div className="space-y-4">
                                {filteredCustomers.length === 0 ? (
                                    <div className="bg-slate-800 border border-slate-700 rounded-xl p-12 text-center">
                                        <div className="text-6xl mb-4">üë•</div>
                                        <p className="text-xl text-slate-400">No customers found</p>
                                    </div>
                                ) : (
                                    filteredCustomers.map(customer => {
                                        const stats = getCustomerStats(customer.id);
                                        return (
                                            <div key={customer.id} className="bg-slate-800 border border-slate-700 rounded-xl p-6 hover:border-red-700 transition card-hover">
                                                <div className="flex justify-between items-start mb-4">
                                                    <div className="flex-1">
                                                        <h3 className="text-xl font-bold text-white mb-3">{customer.name}</h3>
                                                        <div className="grid md:grid-cols-2 gap-4 text-sm mb-4">
                                                            <div>
                                                                <p className="text-slate-500">Email</p>
                                                                <p className="text-white">{customer.email}</p>
                                                            </div>
                                                            <div>
                                                                <p className="text-slate-500">Company</p>
                                                                <p className="text-white">{customer.company}</p>
                                                            </div>
                                                            <div>
                                                                <p className="text-slate-500">Phone</p>
                                                                <p className="text-white">{customer.phone}</p>
                                                            </div>
                                                            <div>
                                                                <p className="text-slate-500">Joined</p>
                                                                <p className="text-white">{new Date(customer.createdAt).toLocaleDateString()}</p>
                                                            </div>
                                                            <div className="md:col-span-2">
                                                                <p className="text-slate-500">Address</p>
                                                                <p className="text-white">{customer.address}</p>
                                                            </div>
                                                        </div>

                                                        {/* Customer Statistics */}
                                                        <div className="bg-slate-900 rounded-lg p-4 mt-4">
                                                            <p className="text-sm text-slate-400 mb-2">Service Request Statistics</p>
                                                            <div className="grid grid-cols-4 gap-4">
                                                                <div>
                                                                    <p className="text-xs text-slate-500">Total</p>
                                                                    <p className="text-lg font-bold text-white">{stats.total}</p>
                                                                </div>
                                                                <div>
                                                                    <p className="text-xs text-slate-500">Pending</p>
                                                                    <p className="text-lg font-bold text-yellow-500">{stats.pending}</p>
                                                                </div>
                                                                <div>
                                                                    <p className="text-xs text-slate-500">Active</p>
                                                                    <p className="text-lg font-bold text-blue-500">{stats.active}</p>
                                                                </div>
                                                                <div>
                                                                    <p className="text-xs text-slate-500">Completed</p>
                                                                    <p className="text-lg font-bold text-green-500">{stats.completed}</p>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div className="flex gap-2">
                                                    <button
                                                        onClick={() => handleEditCustomer(customer)}
                                                        className="px-4 py-2 bg-blue-700 hover:bg-blue-600 text-white rounded-lg font-semibold transition text-sm"
                                                    >
                                                        ‚úé Edit
                                                    </button>
                                                    <button
                                                        onClick={() => {
                                                            setCurrentView('admin-requests');
                                                            // Could filter by customer if we added that state
                                                        }}
                                                        className="px-4 py-2 bg-purple-700 hover:bg-purple-600 text-white rounded-lg font-semibold transition text-sm"
                                                    >
                                                        üìã View Requests
                                                    </button>
                                                    <button
                                                        onClick={() => handleDeleteCustomer(customer.id)}
                                                        className="px-4 py-2 bg-red-700 hover:bg-red-600 text-white rounded-lg font-semibold transition text-sm"
                                                    >
                                                        üóë Delete
                                                    </button>
                                                </div>
                                            </div>
                                        );
                                    })
                                )}
                            </div>

                            {/* Edit Modal */}
                            {showEditModal && editingCustomer && (
                                <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4">
                                    <div className="bg-slate-800 border border-slate-700 rounded-xl p-8 max-w-2xl w-full max-h-[80vh] overflow-y-auto">
                                        <h2 className="text-2xl font-bold text-white mb-6">Edit Customer</h2>
                                        
                                        <div className="space-y-4">
                                            <div>
                                                <label className="block text-sm font-medium text-slate-300 mb-2">Name</label>
                                                <input
                                                    type="text"
                                                    value={editingCustomer.name}
                                                    onChange={(e) => setEditingCustomer({...editingCustomer, name: e.target.value})}
                                                    className="w-full px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:border-red-700 focus:outline-none"
                                                />
                                            </div>
                                            <div>
                                                <label className="block text-sm font-medium text-slate-300 mb-2">Company</label>
                                                <input
                                                    type="text"
                                                    value={editingCustomer.company}
                                                    onChange={(e) => setEditingCustomer({...editingCustomer, company: e.target.value})}
                                                    className="w-full px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:border-red-700 focus:outline-none"
                                                />
                                            </div>
                                            <div>
                                                <label className="block text-sm font-medium text-slate-300 mb-2">Email</label>
                                                <input
                                                    type="email"
                                                    value={editingCustomer.email}
                                                    onChange={(e) => setEditingCustomer({...editingCustomer, email: e.target.value})}
                                                    className="w-full px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:border-red-700 focus:outline-none"
                                                />
                                            </div>
                                            <div>
                                                <label className="block text-sm font-medium text-slate-300 mb-2">Phone</label>
                                                <input
                                                    type="tel"
                                                    value={editingCustomer.phone}
                                                    onChange={(e) => setEditingCustomer({...editingCustomer, phone: e.target.value})}
                                                    className="w-full px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:border-red-700 focus:outline-none"
                                                />
                                            </div>
                                            <div>
                                                <label className="block text-sm font-medium text-slate-300 mb-2">Address</label>
                                                <textarea
                                                    value={editingCustomer.address}
                                                    onChange={(e) => setEditingCustomer({...editingCustomer, address: e.target.value})}
                                                    className="w-full px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:border-red-700 focus:outline-none"
                                                    rows="2"
                                                />
                                            </div>
                                        </div>

                                        <div className="flex gap-3 mt-6">
                                            <button
                                                onClick={handleSaveEdit}
                                                className="flex-1 py-3 bg-green-700 hover:bg-green-600 text-white rounded-lg font-semibold transition"
                                            >
                                                Save Changes
                                            </button>
                                            <button
                                                onClick={() => {
                                                    setShowEditModal(false);
                                                    setEditingCustomer(null);
                                                }}
                                                className="flex-1 py-3 bg-slate-700 hover:bg-slate-600 text-white rounded-lg font-semibold transition"
                                            >
                                                Cancel
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            )}
                        </div>
                    </div>
                );
            };

            return (
                <div>
                    {currentView === 'landing' && <LandingPage />}
                    {currentView === 'login' && <LoginPage />}
                    {currentView === 'register' && <RegisterPage />}
                    {currentView === 'register-technician' && <RegisterTechnicianPage />}
                    {currentView === 'customer-dashboard' && <CustomerDashboard />}
                    {currentView === 'customer-new-request' && <CustomerNewRequest />}
                    {currentView === 'admin-dashboard' && <AdminDashboard />}
                    {currentView === 'admin-requests' && <AdminRequestsPage />}
                    {currentView === 'admin-technicians' && <AdminTechniciansPage />}
                    {currentView === 'admin-customers' && <AdminCustomersPage />}
                    {currentView === 'technician-dashboard' && <TechnicianDashboard />}
                </div>
            );
        };

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
